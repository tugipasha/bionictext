<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BionicText</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, query, where, orderBy, serverTimestamp, deleteDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAOZ10VpzGysk0KWxo0y26ix8ZNAcdpq_4",
            authDomain: "bionictext-ai-7f98e.firebaseapp.com",
            projectId: "bionictext-ai-7f98e",
            storageBucket: "bionictext-ai-7f98e.firebasestorage.app",
            messagingSenderId: "-",
            appId: "1:YOUR_PROJECT_NUMBER:web:d10beff107a257d344cc31",
            measurementId: "G-MDF68KE75Q"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const analytics = getAnalytics(app);

        // Make Firebase services available globally
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseServices = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            collection,
            addDoc,
            getDocs,
            query,
            where,
            orderBy,
            serverTimestamp,
            deleteDoc
        };
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1a2b4c',
                        secondary: '#ffffff'
                    }
                }
            }
        }
    </script>
    <style>
        :root {
    --font-family: 'Inter', sans-serif;
    --line-height: 1.5;
    --word-spacing: 0.1rem;
    --letter-spacing: 0.05rem;
    --font-size: 16px;
    --bg-color: #f9fafb;
    --text-color: #1a2b4c;
    --primary-color: #1a2b4c;
    --link-color: #2563eb;
}

    body {
        font-family: var(--font-family);
        line-height: var(--line-height);
        word-spacing: var(--word-spacing);
        letter-spacing: var(--letter-spacing);
        font-size: var(--font-size);
        background-color: var(--bg-color);
        color: var(--text-color);
    }

    .primary {
        color: var(--primary-color);
    }

    a {
        color: var(--link-color);
    }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        /*body { font-family: 'Inter', sans-serif; }*/
        .bionic-text { font-weight: 400; }
        .bionic-text .bold { font-weight: 700; color: #1a2b4c; }
        .bionic-bold {
            font-weight: 700; /* sadece o kÄ±smÄ± kalÄ±n yap */
        }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .progress-bar { transition: width 0.3s ease; }
        .modal { backdrop-filter: blur(10px); }

        /* Disleksi dostu fontlar */
    @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap');

    /* OpenDyslexic font iÃ§in (CDN veya local) */
    @font-face {
        font-family: 'OpenDyslexic';
        src: url('https://cdn.jsdelivr.net/npm/open-dyslexic@1.0.3/otf/OpenDyslexic-Regular.otf') format('opentype');
        font-weight: normal;
        font-style: normal;
    }

    /* Disleksi dostu stiller */
    .dyslexia-friendly {
        font-family: 'OpenDyslexic', 'Comic Sans MS', sans-serif;
        line-height: 1.6;
        letter-spacing: 0.05rem;
        word-spacing: 0.1rem;
    }

    /* Ã–zel stiller iÃ§in utility classes */
    .line-height-1 { line-height: 1; }
    .line-height-1-5 { line-height: 1.5; }
    .line-height-2 { line-height: 2; }

    .letter-spacing-tight { letter-spacing: -0.02rem; }
    .letter-spacing-normal { letter-spacing: 0; }
    .letter-spacing-wide { letter-spacing: 0.1rem; }

    .word-spacing-tight { word-spacing: -0.1rem; }
    .word-spacing-normal { word-spacing: 0; }
    .word-spacing-wide { word-spacing: 0.2rem; }
    </style>
</head>
<body class="min-h-screen">
    <!-- Navigation -->    
    <nav class="bg-primary shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-white text-xl font-bold">BionicText</h1>
                    </div>
                    <div class="hidden md:block ml-10" aria-hidden="true">
                        <div class="flex items-baseline space-x-4">
                            <button onclick="showSection('home')" class="nav-btn text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_home">Home</button>
                            <button onclick="showSection('test')" class="nav-btn text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_test">Test</button>
                            <button onclick="showSection('converter')" class="nav-btn text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_converter">Converter</button>
                            <button onclick="showSection('assistant')" class="nav-btn text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_assistant">AI Assistant</button>
                            <button onclick="showSection('profile')" class="nav-btn text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_profile">Profile</button>
                            <button onclick="showSection('leaderboard')" class="nav-btn text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_leaderboard">Leaderboard</button>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Mobile menu toggle (visible on small screens) -->
                    <button type="button" class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobileMenu" aria-expanded="false" onclick="toggleMobileMenu()">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                    <!-- Language Selector -->
                    <div class="relative">
                        <select id="languageSelector" onchange="changeLanguage()" class="bg-white text-primary px-3 py-2 rounded-lg text-sm font-medium border-0 focus:ring-2 focus:ring-blue-300 cursor-pointer">
                            <option value="en">ðŸ‡ºðŸ‡¸ English</option>
                            <option value="tr" selected>ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e</option>
                            <option value="it">ðŸ‡®ðŸ‡¹ Italiano</option>
                        </select>
                    </div>

                    <button onclick="showSection('settings')" class="nav-btn hidden md:inline-flex text-gray-300 hover:text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" data-translate="nav_settings">Ayarlar</button>
                    
                    <!-- Login Button (shown when not logged in) -->
                    <div id="authButtons">
                        <button onclick="showAuth()" class="bg-white text-primary px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-100 transition-colors" data-translate="login">Login</button>
                    </div>
                    
                    <!-- Profile Menu (shown when logged in) -->
                    <div id="userMenu" class="hidden relative">
                        <button onclick="toggleProfileMenu()" class="flex items-center space-x-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-3 py-2 rounded-lg transition-colors">
                            <div class="w-8 h-8 bg-white bg-opacity-30 rounded-full flex items-center justify-center">
                                <span id="userInitialsNav" class="text-sm font-semibold">U</span>
                            </div>
                            <span id="userNameNav" class="text-sm font-medium hidden md:block">User</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="profileDropdown" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
                            <div class="p-4 border-b border-gray-200">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center">
                                        <span id="userInitialsDropdown" class="text-white font-semibold">U</span>
                                    </div>
                                    <div>
                                        <div id="userNameDropdown" class="font-medium text-gray-900">User</div>
                                        <div id="userEmailDropdown" class="text-sm text-gray-500">user@example.com</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="py-2">
                                <button onclick="showSection('profile'); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-3">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                    <span data-translate="profile_menu_profile">My Profile</span>
                                </button>
                                
                                <button onclick="showSection('test'); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-3">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                    <span data-translate="profile_menu_test">Take Reading Test</span>
                                </button>
                                
                                <button onclick="showSection('converter'); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-3">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    <span data-translate="profile_menu_converter">Convert Text</span>
                                </button>
                                
                                <button onclick="showSection('assistant'); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-3">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                    <span data-translate="profile_menu_assistant">AI Assistant</span>
                                </button>
                                
                                <div class="border-t border-gray-200 mt-2 pt-2">
                                    <button onclick="exportAllData(); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-3">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                        <span data-translate="profile_menu_export">Export Data</span>
                                    </button>
                                    
                                    <button onclick="logout(); closeProfileMenu()" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center space-x-3">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                        </svg>
                                        <span data-translate="profile_menu_logout">Sign Out</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu (shows on small screens) -->
    <div id="mobileMenu" class="md:hidden hidden bg-primary text-white">
        <div class="px-4 pt-2 pb-3 space-y-1">
            <button onclick="showSection('home')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_home">Home</button>
            <button onclick="showSection('test')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_test">Test</button>
            <button onclick="showSection('converter')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_converter">Converter</button>
            <button onclick="showSection('assistant')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_assistant">AI Assistant</button>
            <button onclick="showSection('profile')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_profile">Profile</button>
            <button onclick="showSection('settings')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_settings">Ayarlar</button>
            <button onclick="showSection('leaderboard'); loadLeaderboard()" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700" data-translate="nav_leaderboard">Leaderboard</button>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-primary mb-2" data-translate="auth_welcome">Welcome Back</h2>
                <p class="text-gray-600" data-translate="auth_signin_subtitle">Sign in to your account</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="auth_email">Email</label>
                    <input type="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all" data-translate-placeholder="auth_email_placeholder" placeholder="Enter your email">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="auth_password">Password</label>
                    <div class="relative">
                        <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all pr-12" data-translate-placeholder="auth_password_placeholder" placeholder="Enter your password">
                        <button onclick="togglePassword()" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            
            <button onclick="login()" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors mt-6" data-translate="auth_signin">Sign In</button>
            
            <div class="text-center mt-4">
                <span class="text-gray-600" data-translate="auth_no_account">Don't have an account? </span>
                <button onclick="toggleAuthMode()" class="text-primary font-medium hover:underline" data-translate="auth_signup">Sign up</button>
            </div>
            
            <button onclick="closeAuth()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <!-- Settings Section -->
<div id="settingsSection" class="section hidden">
    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-primary mb-4" data-translate="settings_title">Okuma AyarlarÄ±</h2>
            <p class="text-gray-600" data-translate="settings_subtitle">GÃ¶rsel ihtiyaÃ§larÄ±nÄ±za gÃ¶re okuma deneyiminizi kiÅŸiselleÅŸtirin</p>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-8">
            <!-- Font SeÃ§imi -->
            <div class="mb-8">
                <h3 class="text-xl font-semibold text-primary mb-4" data-translate="settings_font">YazÄ± Tipi</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="changeFont('opendyslexic')" class="font-option p-4 border-2 border-gray-200 rounded-lg hover:border-primary transition-colors" data-font="opendyslexic">
                        <div class="text-center">
                            <div class="text-lg mb-2">OpenDyslexic</div>
                            <div class="text-sm text-gray-600" style="font-family: 'OpenDyslexic'">Ã–rnek Metin</div>
                        </div>
                    </button>
                    <button onclick="changeFont('comic-sans')" class="font-option p-4 border-2 border-gray-200 rounded-lg hover:border-primary transition-colors" data-font="comic-sans">
                        <div class="text-center">
                            <div class="text-lg mb-2">Comic Sans</div>
                            <div class="text-sm text-gray-600" style="font-family: 'Comic Sans MS'">Ã–rnek Metin</div>
                        </div>
                    </button>
                    <button onclick="changeFont('arial')" class="font-option p-4 border-2 border-gray-200 rounded-lg hover:border-primary transition-colors" data-font="arial">
                        <div class="text-center">
                            <div class="text-lg mb-2">Arial</div>
                            <div class="text-sm text-gray-600" style="font-family: Arial">Ã–rnek Metin</div>
                        </div>
                    </button>
                    <button onclick="changeFont('verdana')" class="font-option p-4 border-2 border-gray-200 rounded-lg hover:border-primary transition-colors" data-font="verdana">
                        <div class="text-center">
                            <div class="text-lg mb-2">Verdana</div>
                            <div class="text-sm text-gray-600" style="font-family: Verdana">Ã–rnek Metin</div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Metin AyarlarÄ± -->
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- SatÄ±r AralÄ±ÄŸÄ± -->
                <div>
                    <h3 class="text-lg font-semibold text-primary mb-3" data-translate="settings_line_height">SatÄ±r AralÄ±ÄŸÄ±</h3>
                    <input type="range" min="1" max="2.5" step="0.1" value="1.5" class="w-full" id="lineHeightSlider" oninput="changeLineHeight(this.value)">
                    <div class="text-sm text-gray-600 text-center mt-2">
                        <span id="lineHeightValue">1.5</span> katÄ±
                    </div>
                </div>

                <!-- Kelime AralÄ±ÄŸÄ± -->
                <div>
                    <h3 class="text-lg font-semibold text-primary mb-3" data-translate="settings_word_spacing">Kelime AralÄ±ÄŸÄ±</h3>
                    <input type="range" min="0" max="1" step="0.1" value="0.1" class="w-full" id="wordSpacingSlider" oninput="changeWordSpacing(this.value)">
                    <div class="text-sm text-gray-600 text-center mt-2">
                        <span id="wordSpacingValue">0.1</span> rem
                    </div>
                </div>

                <!-- Harf AralÄ±ÄŸÄ± -->
                <div>
                    <h3 class="text-lg font-semibold text-primary mb-3" data-translate="settings_letter_spacing">Harf AralÄ±ÄŸÄ±</h3>
                    <input type="range" min="0" max="0.2" step="0.01" value="0.05" class="w-full" id="letterSpacingSlider" oninput="changeLetterSpacing(this.value)">
                    <div class="text-sm text-gray-600 text-center mt-2">
                        <span id="letterSpacingValue">0.05</span> rem
                    </div>
                </div>

                <!-- YazÄ± Boyutu -->
                <div>
                    <h3 class="text-lg font-semibold text-primary mb-3" data-translate="settings_font_size">YazÄ± Boyutu</h3>
                    <input type="range" min="14" max="24" step="1" value="16" class="w-full" id="fontSizeSlider" oninput="changeFontSize(this.value)">
                    <div class="text-sm text-gray-600 text-center mt-2">
                        <span id="fontSizeValue">16</span> px
                    </div>
                </div>
            </div>

            <!-- Renk AyarlarÄ± -->
            <div class="mb-8">
                <h3 class="text-xl font-semibold text-primary mb-4" data-translate="settings_colors">Renk AyarlarÄ±</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="settings_bg_color">Arkaplan Rengi</label>
                        <input type="color" value="#f9fafb" class="w-full h-10 rounded" id="bgColorPicker" onchange="changeBackgroundColor(this.value)">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="settings_text_color">Metin Rengi</label>
                        <input type="color" value="#1a2b4c" class="w-full h-10 rounded" id="textColorPicker" onchange="changeTextColor(this.value)">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="settings_primary_color">Ana Renk</label>
                        <input type="color" value="#1a2b4c" class="w-full h-10 rounded" id="primaryColorPicker" onchange="changePrimaryColor(this.value)">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="settings_link_color">BaÄŸlantÄ± Rengi</label>
                        <input type="color" value="#2563eb" class="w-full h-10 rounded" id="linkColorPicker" onchange="changeLinkColor(this.value)">
                    </div>
                </div>
            </div>

            <!-- Ã–nizleme -->
            <div class="mb-8">
                <h3 class="text-xl font-semibold text-primary mb-4" data-translate="settings_preview">Ã–nizleme</h3>
                <div class="bg-gray-100 p-6 rounded-lg" id="previewArea">
                    <p class="text-lg" id="previewText">
                        Bu bir Ã¶rnek metindir. AyarlarÄ±nÄ±zÄ± burada gÃ¶rebilir ve nasÄ±l gÃ¶rÃ¼neceÄŸini test edebilirsiniz. Disleksi dostu ayarlar okumayÄ± kolaylaÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r.
                    </p>
                </div>
            </div>

            <!-- Reset ve Kaydet ButonlarÄ± -->
            <div class="flex gap-4 justify-center">
                <button onclick="resetSettings()" class="bg-gray-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors" data-translate="settings_reset">SÄ±fÄ±rla</button>
                <button onclick="saveSettings()" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="settings_save">Kaydet</button>
            </div>
        </div>
    </div>
</div>

    <!-- Notification Toast -->
    <div id="notification" class="fixed top-4 right-4 z-50 hidden">
        <div class="bg-white border-l-4 border-blue-500 rounded-lg shadow-lg p-4 max-w-sm">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <svg id="notificationIcon" class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                </div>
                <div class="ml-3">
                    <p id="notificationText" class="text-sm font-medium text-gray-900"></p>
                </div>
                <div class="ml-auto pl-3">
                    <button onclick="hideNotification()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Home Section -->
        <div id="homeSection" class="section">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold text-primary mb-6">BionicText AI</h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8" data-translate="home_subtitle">Enhance your reading speed and comprehension with AI-powered text formatting. Experience the future of efficient reading.</p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="showSection('test')" class="bg-primary text-white px-8 py-4 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="home_start_test">Start Reading Test</button>
                    <button onclick="showSection('converter')" class="border-2 border-primary text-primary px-8 py-4 rounded-lg font-medium hover:bg-primary hover:text-white transition-colors" data-translate="home_try_converter">Try Converter</button>
                </div>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8 mt-16">
                <div class="bg-white p-8 rounded-xl shadow-lg text-center">
                    <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-primary mb-3" data-translate="home_speed_reading">Speed Reading</h3>
                    <p class="text-gray-600" data-translate="home_speed_desc">Increase your reading speed by up to 200% with our scientifically-backed BionicText format.</p>
                </div>
                
                <div class="bg-white p-8 rounded-xl shadow-lg text-center">
                    <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-primary mb-3" data-translate="home_comprehension">Better Comprehension</h3>
                    <p class="text-gray-600" data-translate="home_comprehension_desc">Maintain or improve understanding while reading faster through enhanced text formatting.</p>
                </div>
                
                <div class="bg-white p-8 rounded-xl shadow-lg text-center">
                    <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m-9 0h10m-10 0a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V6a2 2 0 00-2-2"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-primary mb-3" data-translate="home_multi_format">Multi-Format Support</h3>
                    <p class="text-gray-600" data-translate="home_multi_format_desc">Convert text, PDFs, and even speech to BionicText format with our advanced AI tools.</p>
                </div>
            </div>
        </div>

        <!-- Reading Speed Test Section -->
        <div id="testSection" class="section hidden">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-primary mb-4" data-translate="test_title">Reading Speed Test</h2>
                    <p class="text-gray-600" data-translate="test_subtitle">Compare your reading speed with normal text vs. BionicText format</p>
                </div>

                <!-- Test Step 1: Normal Text -->
                <div id="testStep1" class="bg-white rounded-xl shadow-lg p-8 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-primary" data-translate="test_step1">Step 1: Normal Text Reading</h3>
                        <div class="text-sm text-gray-500">
                            <span id="timer1">00:00</span>
                        </div>
                    </div>

                    <!-- Text Selection Options -->
                    <div class="mb-4">
                        <div class="flex flex-wrap gap-2 mb-4">
                            <button onclick="setTestTextMode('preset')" class="test-text-btn bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium" data-translate="test_preset_text">Preset Text</button>
                            <button onclick="setTestTextMode('custom')" class="test-text-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300" data-translate="test_custom_text">Custom Text</button>
                        </div>
                    </div>

                    <!-- Preset Text Mode -->
                    <div id="presetTextMode" class="test-text-mode">
                        <div class="mb-4">
                            <select id="presetTextSelect" onchange="loadPresetText()" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="ai" data-translate="test_preset_ai">AI Technology</option>
                                <option value="science" data-translate="test_preset_science">Science & Nature</option>
                                <option value="history" data-translate="test_preset_history">History</option>
                                <option value="literature" data-translate="test_preset_literature">Literature</option>
                            </select>
                        </div>
                        <div id="presetTextContent" class="bg-gray-50 p-6 rounded-lg mb-6 text-lg leading-relaxed">
                            <p id="testText1">The rapid advancement of artificial intelligence has transformed numerous industries and aspects of daily life. From healthcare diagnostics to autonomous vehicles, AI systems are becoming increasingly sophisticated and capable. Machine learning algorithms can now process vast amounts of data to identify patterns and make predictions with remarkable accuracy. Natural language processing has enabled computers to understand and generate human-like text, revolutionizing communication and content creation. As we continue to develop these technologies, it becomes crucial to consider their ethical implications and ensure they benefit society as a whole. The future of AI holds immense potential for solving complex global challenges, but it also requires careful consideration of privacy, security, and the impact on employment markets.</p>
                        </div>
                    </div>

                    <!-- Custom Text Mode -->
                    <div id="customTextMode" class="test-text-mode hidden">
                        <div class="mb-4">
                            <textarea id="customTestText" class="w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none" data-translate-placeholder="test_custom_placeholder" placeholder="Enter your own text here for the reading test..."></textarea>
                            <div class="flex justify-between items-center mt-2 text-sm text-gray-500">
                                <span data-translate="test_word_count">Word count: <span id="customWordCount">0</span></span>
                                <span data-translate="test_recommended">Recommended: 100-200 words</span>
                            </div>
                        </div>
                        <div id="customTextDisplay" class="bg-gray-50 p-6 rounded-lg mb-6 text-lg leading-relaxed hidden">
                            <p id="customDisplayText"></p>
                        </div>
                        <button onclick="loadCustomText()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors mb-4" data-translate="test_load_custom">Load Custom Text</button>
                    </div>
                    
                    <div class="flex gap-4">
                        <button id="startBtn1" onclick="startTimer(1)" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="test_start_timer">Start Timer</button>
                        <button id="finishBtn1" onclick="finishTimer(1)" class="bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:bg-gray-400" disabled data-translate="test_finish_timer">Finish Timer</button>
                    </div>
                </div>

                <!-- Test Step 2: BionicText -->
                <div id="testStep2" class="bg-white rounded-xl shadow-lg p-8 mb-6 hidden">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-primary" data-translate="test_step2">Step 2: BionicText Reading</h3>
                        <div class="text-sm text-gray-500">
                            <span id="timer2">00:00</span>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg mb-6 text-lg leading-relaxed">
                        <p id="testText2"><span class="bionic-bold">Th</span>e <span class="bionic-bold">rap</span>id <span class="bionic-bold">adv</span>ancement of <span class="bionic-bold">art</span>ificial <span class="bionic-bold">int</span>elligence has <span class="bionic-bold">tra</span>nsformed <span class="bionic-bold">num</span>erous <span class="bionic-bold">ind</span>ustries and <span class="bionic-bold">asp</span>ects of <span class="bionic-bold">dai</span>ly life. <span class="bionic-bold">Fr</span>om <span class="bionic-bold">hea</span>lthcare <span class="bionic-bold">dia</span>gnostics to <span class="bionic-bold">aut</span>onomous <span class="bionic-bold">veh</span>icles, AI <span class="bionic-bold">sys</span>tems are <span class="bionic-bold">bec</span>oming <span class="bionic-bold">inc</span>reasingly <span class="bionic-bold">sop</span>histicated and <span class="bionic-bold">cap</span>able. <span class="bionic-bold">Mac</span>hine <span class="bionic-bold">lea</span>rning <span class="bionic-bold">alg</span>orithms can now <span class="bionic-bold">pro</span>cess vast <span class="bionic-bold">amo</span>unts of data to <span class="bionic-bold">ide</span>ntify <span class="bionic-bold">pat</span>terns and make <span class="bionic-bold">pre</span>dictions <span class="bionic-bold">wi</span>th <span class="bionic-bold">rem</span>arkable <span class="bionic-bold">acc</span>uracy.</p>
                    </div>
                    
                    <div class="flex gap-4">
                        <button id="startBtn2" onclick="startTimer(2)" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="test_start_timer">Start Timer</button>
                        <button id="finishBtn2" onclick="finishTimer(2)" class="bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:bg-gray-400" disabled data-translate="test_finish_timer">Finish Timer</button>
                    </div>
                </div>

                <!-- Test Results -->
                <div id="testResults" class="bg-white rounded-xl shadow-lg p-8 hidden">
                    <h3 class="text-2xl font-semibold text-primary mb-6 text-center" data-translate="test_results_title">Your Reading Speed Results</h3>
                    
                    <div class="grid md:grid-cols-2 gap-8 mb-8">
                        <div class="text-center">
                            <h4 class="text-lg font-medium text-gray-700 mb-2" data-translate="test_normal_text">Normal Text</h4>
                            <div class="text-3xl font-bold text-primary mb-2" id="normalWPM">0</div>
                            <div class="text-sm text-gray-500" data-translate="test_wpm">words per minute</div>
                        </div>
                        
                        <div class="text-center">
                            <h4 class="text-lg font-medium text-gray-700 mb-2" data-translate="test_bionic_text">BionicText</h4>
                            <div class="text-3xl font-bold text-primary mb-2" id="bionicWPM">0</div>
                            <div class="text-sm text-gray-500" data-translate="test_wpm">words per minute</div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700" data-translate="test_improvement">Speed Improvement</span>
                            <span class="text-sm font-bold text-primary" id="improvement">+0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div class="bg-primary h-3 rounded-full progress-bar" id="progressBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="flex gap-4 justify-center">
                        <button onclick="downloadResults()" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="test_download_report">Download PDF Report</button>
                        <button onclick="resetTest()" class="border-2 border-primary text-primary px-6 py-3 rounded-lg font-medium hover:bg-primary hover:text-white transition-colors" data-translate="test_take_again">Take Test Again</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Converter Section -->
        <div id="converterSection" class="section hidden">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-primary mb-4" data-translate="converter_title">BionicText Converter</h2>
                    <p class="text-gray-600" data-translate="converter_subtitle">Transform any text into BionicText format for enhanced reading speed</p>
                </div>

                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Input Section -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold text-primary mb-4" data-translate="converter_input_text">Input Text</h3>
                        
                        <div class="mb-4">
                            <div class="flex flex-wrap gap-2 mb-4">
                                <button onclick="setInputMode('text')" class="input-mode-btn bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium" data-translate="converter_text_input">Text Input</button>
                                <button onclick="setInputMode('file')" class="input-mode-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300" data-translate="converter_file_upload">File Upload</button>
                                <button onclick="setInputMode('voice')" class="input-mode-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300" data-translate="converter_voice_input">Voice Input</button>
                            </div>
                        </div>

                        <!-- Text Input Mode -->
                        <div id="textInputMode" class="input-mode">
                            <textarea id="inputText" class="w-full h-64 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none resize-none" data-translate-placeholder="converter_paste_text" placeholder="Paste your text here or start typing..."></textarea>
                        </div>

                        <!-- File Upload Mode -->
                        <div id="fileInputMode" class="input-mode hidden">
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors">
                                <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                </svg>
                                <p class="text-gray-600 mb-2" data-translate="converter_drop_file">Drop your PDF or TXT file here</p>
                                <p class="text-sm text-gray-500 mb-4" data-translate="converter_click_browse">or click to browse</p>
                                <input type="file" id="fileInput" accept=".pdf,.txt" class="hidden" onchange="handleFileUpload(event)">
                                <button onclick="document.getElementById('fileInput').click()" class="bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-800 transition-colors" data-translate="converter_choose_file">Choose File</button>
                            </div>
                        </div>

                        <!-- Voice Input Mode -->
                        <div id="voiceInputMode" class="input-mode hidden">
                            <div class="text-center p-8">
                                <div class="w-24 h-24 bg-primary rounded-full flex items-center justify-center mx-auto mb-4 cursor-pointer hover:bg-blue-800 transition-colors" onclick="toggleVoiceRecording()">
                                    <svg id="micIcon" class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                                    </svg>
                                </div>
                                <p class="text-gray-600 mb-2" data-translate="converter_click_record">Click to start recording</p>
                                <p class="text-sm text-gray-500" data-translate="converter_speak_clearly">Speak clearly for best results</p>
                                <div id="recordingStatus" class="mt-4 text-sm text-primary hidden" data-translate="converter_recording">Recording... Click to stop</div>
                            </div>
                        </div>

                        <button onclick="convertText()" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors mt-4" data-translate="converter_convert">Convert to BionicText</button>
                    </div>

                    <!-- Output Section -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold text-primary" data-translate="converter_output">BionicText Output</h3>
                            <div class="flex gap-2">
                                <select id="fontSize" onchange="updateFontSize()" class="px-3 py-1 border border-gray-300 rounded text-sm">
                                    <option value="16">16px</option>
                                    <option value="18" selected>18px</option>
                                    <option value="20">20px</option>
                                    <option value="24">24px</option>
                                </select>
                                <select id="fontFamily" onchange="updateFontFamily()" class="px-3 py-1 border border-gray-300 rounded text-sm">
                                    <option value="Inter">Inter</option>
                                    <option value="Arial">Arial</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Times New Roman">Times</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="bionicOutput" class="h-64 p-4 border border-gray-300 rounded-lg overflow-y-auto bg-gray-50" style="font-size: 18px;">
                            <p class="text-gray-500 italic" data-translate="converter_output_placeholder">Your converted BionicText will appear here...</p>
                        </div>

                        <div class="flex gap-2 mt-4">
                            <button onclick="exportToPDF()" class="flex-1 bg-primary text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-800 transition-colors text-sm" data-translate="converter_export_pdf">Export PDF</button>
                            <button onclick="exportToTXT()" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors text-sm" data-translate="converter_export_txt">Export TXT</button>
                            <button onclick="speakText()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors text-sm" data-translate="converter_speak">ðŸ”Š Speak</button>
                        </div>

                        <!-- TTS Options -->
                        <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                            <h4 class="text-sm font-medium text-gray-700 mb-2" data-translate="converter_tts_options">Text-to-Speech Options</h4>
                            <div class="flex gap-2">
                                <select id="voiceLanguage" class="flex-1 px-3 py-2 border border-gray-300 rounded text-sm">
                                    <option value="en-US">English (US)</option>
                                    <option value="tr-TR" selected>Turkish</option>
                                    <option value="es-ES">Spanish</option>
                                    <option value="it-IT">Italian</option>
                                    <option value="fr-FR">French</option>
                                </select>
                                <select id="voiceSpeed" class="px-3 py-2 border border-gray-300 rounded text-sm">
                                    <option value="0.8">Slow</option>
                                    <option value="1" selected>Normal</option>
                                    <option value="1.2">Fast</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Assistant Section -->
        <div id="assistantSection" class="section hidden">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-primary mb-4" data-translate="assistant_title">AI Assistant</h2>
                    <p class="text-gray-600" data-translate="assistant_subtitle">Ask me anything about BionicText, reading techniques, or your personal reading data!</p>
                </div>

                <!-- Chat Container -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <!-- Chat Header -->
                    <div class="bg-primary text-white p-4 flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold" data-translate="assistant_name">BionicText AI Assistant</h3>
                                <p class="text-sm opacity-90" data-translate="assistant_status">Online â€¢ Ready to help</p>
                            </div>
                        </div>
                        <button onclick="clearChat()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors" title="Clear chat">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- Chat Messages -->
                    <div id="chatMessages" class="h-96 overflow-y-auto p-4 space-y-4 bg-gray-50">
                        <!-- Welcome Message -->
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                            </div>
                            <div class="bg-white rounded-lg p-3 shadow-sm max-w-md">
                                <p class="text-gray-800" data-translate="assistant_welcome">Hello! I'm your BionicText AI Assistant. I can help you with:</p>
                                <ul class="mt-2 text-sm text-gray-600 space-y-1">
                                    <li data-translate="assistant_help_1">â€¢ Questions about BionicText and speed reading</li>
                                    <li data-translate="assistant_help_2">â€¢ Analysis of your reading performance</li>
                                    <li data-translate="assistant_help_3">â€¢ Tips to improve your reading speed</li>
                                    <li data-translate="assistant_help_4">â€¢ General questions about anything!</li>
                                </ul>
                                <p class="mt-2 text-sm text-gray-500" data-translate="assistant_ask">What would you like to know?</p>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Suggestions -->
                    <div class="p-4 border-t bg-white">
                        <div class="flex flex-wrap gap-2 mb-4">
                            <button onclick="sendQuickMessage('What is BionicText and how does it work?')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-full text-sm transition-colors" data-translate="quick_what_bionic">What is BionicText?</button>
                            <button onclick="sendQuickMessage('How can I improve my reading speed?')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-full text-sm transition-colors" data-translate="quick_improve_speed">Improve reading speed</button>
                            <button onclick="sendQuickMessage('Show me my reading statistics')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-full text-sm transition-colors" data-translate="quick_my_stats">My statistics</button>
                            <button onclick="sendQuickMessage('What are the benefits of speed reading?')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-full text-sm transition-colors" data-translate="quick_benefits">Speed reading benefits</button>
                        </div>

                        <!-- Chat Input -->
                        <div class="flex space-x-3">
                            <input type="text" id="chatInput" placeholder="Type your message..." class="flex-1 border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-transparent outline-none" data-translate-placeholder="assistant_input_placeholder" onkeypress="handleChatKeyPress(event)">
                            <button onclick="sendMessage()" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors flex items-center space-x-2" id="sendButton">
                                <span data-translate="assistant_send">Send</span>
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI Features Info -->
                <div class="mt-8 grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2" data-translate="assistant_feature_1">Smart Analysis</h3>
                        <p class="text-sm text-gray-600" data-translate="assistant_feature_1_desc">Get insights about your reading patterns and performance trends</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2" data-translate="assistant_feature_2">Personalized Tips</h3>
                        <p class="text-sm text-gray-600" data-translate="assistant_feature_2_desc">Receive customized advice based on your reading data and goals</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                        </div>
                        <h3 class="font-semibold text-gray-800 mb-2" data-translate="assistant_feature_3">24/7 Support</h3>
                        <p class="text-sm text-gray-600" data-translate="assistant_feature_3_desc">Ask questions anytime about reading techniques and BionicText</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="section hidden">
            <div class="max-w-6xl mx-auto">
                <!-- Profile Header -->
                <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center">
                                <span class="text-white text-xl font-bold" id="userInitials">U</span>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-primary" id="profileUserName" data-translate="profile_title">User Profile</h2>
                                <p class="text-gray-600" id="profileUserEmail">user@example.com</p>
                                <p class="text-sm text-gray-500"><span data-translate="profile_member_since">Member since</span> <span id="memberSince">Today</span></p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-3xl font-bold text-primary" id="totalTests">0</div>
                            <div class="text-sm text-gray-500" data-translate="profile_total_tests">Total Tests</div>
                        </div>
                    </div>
                </div>

                <div class="grid lg:grid-cols-3 gap-8">
                    <!-- Reading Statistics -->
                    <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold text-primary mb-6">Reading Statistics</h3>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-blue-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-primary" id="avgNormalSpeed">0</div>
                                <div class="text-sm text-gray-600">Avg Normal Speed (WPM)</div>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-green-600" id="avgBionicSpeed">0</div>
                                <div class="text-sm text-gray-600">Avg BionicText Speed (WPM)</div>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-purple-600" id="avgImprovement">0%</div>
                                <div class="text-sm text-gray-600">Average Improvement</div>
                            </div>
                            <div class="bg-yellow-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-yellow-600" id="bestImprovement">0%</div>
                                <div class="text-sm text-gray-600">Best Improvement</div>
                            </div>
                        </div>

                        <!-- Progress Chart -->
                        <div class="mb-6">
                            <h4 class="text-lg font-medium text-gray-700 mb-3">Reading Speed Progress</h4>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <canvas id="progressChart" width="400" height="200" class="w-full"></canvas>
                            </div>
                        </div>

                        <!-- Recent Test History -->
                        <div>
                            <h4 class="text-lg font-medium text-gray-700 mb-3">Recent Test Results</h4>
                            <div class="space-y-2" id="recentTests">
                                <div class="text-center text-gray-500 py-8">
                                    <p>No test results yet. Take your first reading speed test!</p>
                                    <button onclick="showSection('test')" class="mt-2 text-primary hover:text-blue-800 font-medium">Start Test</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Achievements & Goals -->
                    <div class="space-y-6">
                        <!-- Achievements -->
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-semibold text-primary">Achievements</h3>
                                <div class="flex items-center space-x-2" id="achievementPagination">
                                    <button id="prevAchievements" class="p-1 rounded-md bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                        </svg>
                                    </button>
                                    <span class="text-sm text-gray-600" id="achievementPageInfo">Page 1</span>
                                    <button id="nextAchievements" class="p-1 rounded-md bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="space-y-3" id="achievements">
                                <!-- Achievements will be loaded here -->
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h3 class="text-xl font-semibold text-primary mb-4">Quick Actions</h3>
                            <div class="space-y-3">
                                <button onclick="showSection('test')" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-800 transition-colors">
                                    Take New Test
                                </button>
                                <button onclick="showSection('converter')" class="w-full border-2 border-primary text-primary py-3 rounded-lg font-medium hover:bg-primary hover:text-white transition-colors">
                                    Convert Text
                                </button>
                                <button onclick="exportAllData()" class="w-full bg-gray-600 text-white py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors">
                                    Export All Data
                                </button>
                                <button onclick="deleteAllData()" class="w-full bg-red-600 text-white py-3 rounded-lg font-medium hover:bg-red-700 transition-colors">
                                    Delete All Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Section -->
        <div id="leaderboardSection" class="section hidden">
            <div class="max-w-6xl mx-auto">
                <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-primary" data-translate="leaderboard_title">Leaderboard</h2>
                        <div class="text-sm text-gray-500" id="leaderboardInfo" data-translate="leaderboard_info">Top users by average BionicText WPM</div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">#</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-translate="leaderboard_user">User</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-translate="leaderboard_avg_bionic">Avg BionicText (WPM)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-translate="leaderboard_tests">Tests</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboardBody" class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Loading...</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let currentSection = 'home';
        let testTimers = { 1: null, 2: null };
        let testStartTimes = { 1: null, 2: null };
        let testResults = { normal: 0, bionic: 0 };
        let isRecording = false;
        let recognition = null;
        let currentLanguage = 'en';
        let chatHistory = [];
        let userTestData = [];
        let currentTestText = '';
        let currentWordCount = 0;
        
        // Achievements pagination
        let currentAchievementPage = 1;
        const achievementsPerPage = 4;

        // Translation data
        const translations = {
            en: {
                // Navigation
                nav_home: "Home",
                nav_test: "Test",
                nav_converter: "Converter",
                nav_assistant: "AI Assistant",
                nav_profile: "Profile",
                nav_leaderboard: "Leaderboard",
                login: "Login",
                logout: "Logout",
                
                // Leaderboard
                leaderboard_title: "Leaderboard",
                leaderboard_info: "Top users by average BionicText WPM",
                leaderboard_user: "User",
                leaderboard_avg_bionic: "Avg BionicText (WPM)",
                leaderboard_tests: "Tests",
                
                // Authentication
                auth_welcome: "Welcome Back",
                auth_signin_subtitle: "Sign in to your account",
                auth_email: "Email",
                auth_password: "Password",
                auth_email_placeholder: "Enter your email",
                auth_password_placeholder: "Enter your password",
                auth_signin: "Sign In",
                auth_signup: "Sign up",
                auth_no_account: "Don't have an account? ",
                auth_create_account: "Create Account",
                auth_signup_subtitle: "Sign up for a new account",
                auth_have_account: "Already have an account? ",
                
                // Home page
                home_subtitle: "Enhance your reading speed and comprehension with AI-powered text formatting. Experience the future of efficient reading.",
                home_start_test: "Start Reading Test",
                home_try_converter: "Try Converter",
                home_speed_reading: "Speed Reading",
                home_speed_desc: "Increase your reading speed by up to 200% with our scientifically-backed BionicText format.",
                home_comprehension: "Better Comprehension",
                home_comprehension_desc: "Maintain or improve understanding while reading faster through enhanced text formatting.",
                home_multi_format: "Multi-Format Support",
                home_multi_format_desc: "Convert text, PDFs, and even speech to BionicText format with our advanced AI tools.",
                
                // Test section
                test_title: "Reading Speed Test",
                test_subtitle: "Compare your reading speed with normal text vs. BionicText format",
                test_step1: "Step 1: Normal Text Reading",
                test_step2: "Step 2: BionicText Reading",
                test_start_timer: "Start Timer",
                test_finish_timer: "Finish Timer",
                test_results_title: "Your Reading Speed Results",
                test_normal_text: "Normal Text",
                test_bionic_text: "BionicText",
                test_wpm: "words per minute",
                test_improvement: "Speed Improvement",
                test_download_report: "Download PDF Report",
                test_take_again: "Take Test Again",
                test_preset_text: "Preset Text",
                test_custom_text: "Custom Text",
                test_preset_ai: "AI Technology",
                test_preset_science: "Science & Nature",
                test_preset_history: "History",
                test_preset_literature: "Literature",
                test_custom_placeholder: "Enter your own text here for the reading test...",
                test_word_count: "Word count:",
                test_recommended: "Recommended: 100-200 words",
                test_load_custom: "Load Custom Text",
                
                // Converter section
                converter_title: "BionicText Converter",
                converter_subtitle: "Transform any text into BionicText format for enhanced reading speed",
                converter_input_text: "Input Text",
                converter_text_input: "Text Input",
                converter_file_upload: "File Upload",
                converter_voice_input: "Voice Input",
                converter_paste_text: "Paste your text here or start typing...",
                converter_drop_file: "Drop your PDF or TXT file here",
                converter_click_browse: "or click to browse",
                converter_choose_file: "Choose File",
                converter_click_record: "Click to start recording",
                converter_speak_clearly: "Speak clearly for best results",
                converter_recording: "Recording... Click to stop",
                converter_convert: "Convert to BionicText",
                converter_output: "BionicText Output",
                converter_output_placeholder: "Your converted BionicText will appear here...",
                converter_export_pdf: "Export PDF",
                converter_export_txt: "Export TXT",
                converter_speak: "ðŸ”Š Speak",
                converter_tts_options: "Text-to-Speech Options",
                
                // Profile section
                profile_title: "User Profile",
                profile_member_since: "Member since",
                profile_total_tests: "Total Tests",
                
                // Profile menu
                profile_menu_profile: "My Profile",
                profile_menu_test: "Take Reading Test",
                profile_menu_converter: "Convert Text",
                profile_menu_assistant: "AI Assistant",
                profile_menu_export: "Export Data",
                profile_menu_logout: "Sign Out",
                profile_reading_stats: "Reading Statistics",
                profile_avg_normal: "Avg Normal Speed (WPM)",
                profile_avg_bionic: "Avg BionicText Speed (WPM)",
                profile_avg_improvement: "Average Improvement",
                profile_best_improvement: "Best Improvement",
                profile_progress: "Reading Speed Progress",
                profile_recent_tests: "Recent Test Results",
                profile_no_tests: "No test results yet. Take your first reading speed test!",
                profile_start_test: "Start Test",
                profile_achievements: "Achievements",
                profile_first_test: "First Test",
                profile_first_test_desc: "Complete your first reading test",
                profile_speed_demon: "Speed Demon",
                profile_speed_demon_desc: "Reach 300+ WPM with BionicText",
                profile_consistent: "Consistent Reader",
                profile_consistent_desc: "Complete 10 tests",
                profile_quick_actions: "Quick Actions",
                profile_take_test: "Take New Test",
                profile_convert_text: "Convert Text",
                profile_export_data: "Export All Data",
                profile_delete_data: "Delete All Data",
                
                // Notifications
                notif_login_success: "Welcome back! Successfully logged in.",
                notif_login_failed: "Login failed: ",
                notif_test_saved: "Test results saved to your profile!",
                notif_signin_to_save: "Sign in to save your test results!",
                notif_data_exported: "Successfully exported test results!",
                notif_data_deleted: "All data deleted successfully",
                notif_no_data_export: "No test data to export. Take some tests first!",
                notif_db_setup: "Database is still setting up. Your data is safe - please try refreshing in a moment.",
                notif_permission_denied: "Permission denied. Please sign out and sign back in.",
                notif_connection_issue: "Temporary connection issue. Your profile is still available.",
                
                // AI Assistant
                assistant_title: "AI Assistant",
                assistant_subtitle: "Ask me anything about BionicText, reading techniques, or your personal reading data!",
                assistant_name: "BionicText AI Assistant",
                assistant_status: "Online â€¢ Ready to help",
                assistant_welcome: "Hello! I'm your BionicText AI Assistant. I can help you with:",
                assistant_help_1: "â€¢ Questions about BionicText and speed reading",
                assistant_help_2: "â€¢ Analysis of your reading performance",
                assistant_help_3: "â€¢ Tips to improve your reading speed",
                assistant_help_4: "â€¢ General questions about anything!",
                assistant_ask: "What would you like to know?",
                assistant_input_placeholder: "Type your message...",
                assistant_send: "Send",
                assistant_feature_1: "Smart Analysis",
                assistant_feature_1_desc: "Get insights about your reading patterns and performance trends",
                assistant_feature_2: "Personalized Tips",
                assistant_feature_2_desc: "Receive customized advice based on your reading data and goals",
                assistant_feature_3: "24/7 Support",
                assistant_feature_3_desc: "Ask questions anytime about reading techniques and BionicText",
                quick_what_bionic: "What is BionicText?",
                quick_improve_speed: "Improve reading speed",
                quick_my_stats: "My statistics",
                quick_benefits: "Speed reading benefits"
            },
            
            tr: {
                // Navigation
                nav_home: "Ana Sayfa",
                nav_test: "Test",
                nav_converter: "DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼",
                nav_assistant: "AI Asistan",
                nav_profile: "Profil",
                nav_leaderboard: "SÄ±ralama",
                login: "GiriÅŸ Yap",
                logout: "Ã‡Ä±kÄ±ÅŸ Yap",
                
                // Leaderboard
                leaderboard_title: "Liderlik Tablosu",
                leaderboard_info: "Ortalama BionicText DKK'ye gÃ¶re en iyi kullanÄ±cÄ±lar",
                leaderboard_user: "KullanÄ±cÄ±",
                leaderboard_avg_bionic: "Ort. BionicText (DKK)",
                leaderboard_tests: "Testler",
                
                // Authentication
                auth_welcome: "Tekrar HoÅŸ Geldiniz",
                auth_signin_subtitle: "HesabÄ±nÄ±za giriÅŸ yapÄ±n",
                auth_email: "E-posta",
                auth_password: "Åžifre",
                auth_email_placeholder: "E-posta adresinizi girin",
                auth_password_placeholder: "Åžifrenizi girin",
                auth_signin: "GiriÅŸ Yap",
                auth_signup: "KayÄ±t Ol",
                auth_no_account: "HesabÄ±nÄ±z yok mu? ",
                auth_create_account: "Hesap OluÅŸtur",
                auth_signup_subtitle: "Yeni hesap oluÅŸturun",
                auth_have_account: "Zaten hesabÄ±nÄ±z var mÄ±? ",
                
                // Home page
                home_subtitle: "AI destekli metin biÃ§imlendirme ile okuma hÄ±zÄ±nÄ±zÄ± ve anlayÄ±ÅŸÄ±nÄ±zÄ± artÄ±rÄ±n. Verimli okumanÄ±n geleceÄŸini deneyimleyin.",
                home_start_test: "Okuma Testini BaÅŸlat",
                home_try_converter: "DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼yÃ¼ Dene",
                home_speed_reading: "HÄ±zlÄ± Okuma",
                home_speed_desc: "Bilimsel olarak desteklenen BionicText formatÄ± ile okuma hÄ±zÄ±nÄ±zÄ± %200'e kadar artÄ±rÄ±n.",
                home_comprehension: "Daha Ä°yi AnlayÄ±ÅŸ",
                home_comprehension_desc: "GeliÅŸmiÅŸ metin biÃ§imlendirme ile daha hÄ±zlÄ± okurken anlayÄ±ÅŸÄ±nÄ±zÄ± koruyun veya geliÅŸtirin.",
                home_multi_format: "Ã‡oklu Format DesteÄŸi",
                home_multi_format_desc: "GeliÅŸmiÅŸ AI araÃ§larÄ±mÄ±zla metin, PDF ve hatta konuÅŸmayÄ± BionicText formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n.",
                
                // Test section
                test_title: "Okuma HÄ±zÄ± Testi",
                test_subtitle: "Normal metin ile BionicText formatÄ±ndaki okuma hÄ±zÄ±nÄ±zÄ± karÅŸÄ±laÅŸtÄ±rÄ±n",
                test_step1: "AdÄ±m 1: Normal Metin Okuma",
                test_step2: "AdÄ±m 2: BionicText Okuma",
                test_start_timer: "ZamanlayÄ±cÄ±yÄ± BaÅŸlat",
                test_finish_timer: "ZamanlayÄ±cÄ±yÄ± Bitir",
                test_results_title: "Okuma HÄ±zÄ± SonuÃ§larÄ±nÄ±z",
                test_normal_text: "Normal Metin",
                test_bionic_text: "BionicText",
                test_wpm: "dakikada kelime",
                test_improvement: "HÄ±z Ä°yileÅŸtirmesi",
                test_download_report: "PDF Rapor Ä°ndir",
                test_take_again: "Testi Tekrar Al",
                test_preset_text: "HazÄ±r Metin",
                test_custom_text: "Ã–zel Metin",
                test_preset_ai: "AI Teknolojisi",
                test_preset_science: "Bilim ve DoÄŸa",
                test_preset_history: "Tarih",
                test_preset_literature: "Edebiyat",
                test_custom_placeholder: "Okuma testi iÃ§in kendi metninizi buraya girin...",
                test_word_count: "Kelime sayÄ±sÄ±:",
                test_recommended: "Ã–nerilen: 100-200 kelime",
                test_load_custom: "Ã–zel Metni YÃ¼kle",
                
                // Converter section
                converter_title: "BionicText DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼",
                converter_subtitle: "GeliÅŸmiÅŸ okuma hÄ±zÄ± iÃ§in herhangi bir metni BionicText formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n",
                converter_input_text: "GiriÅŸ Metni",
                converter_text_input: "Metin GiriÅŸi",
                converter_file_upload: "Dosya YÃ¼kleme",
                converter_voice_input: "Ses GiriÅŸi",
                converter_paste_text: "Metninizi buraya yapÄ±ÅŸtÄ±rÄ±n veya yazmaya baÅŸlayÄ±n...",
                converter_drop_file: "PDF veya TXT dosyanÄ±zÄ± buraya bÄ±rakÄ±n",
                converter_click_browse: "veya gÃ¶z atmak iÃ§in tÄ±klayÄ±n",
                converter_choose_file: "Dosya SeÃ§",
                converter_click_record: "KayÄ±t baÅŸlatmak iÃ§in tÄ±klayÄ±n",
                converter_speak_clearly: "En iyi sonuÃ§lar iÃ§in net konuÅŸun",
                converter_recording: "Kaydediliyor... Durdurmak iÃ§in tÄ±klayÄ±n",
                converter_convert: "BionicText'e DÃ¶nÃ¼ÅŸtÃ¼r",
                converter_output: "BionicText Ã‡Ä±ktÄ±sÄ±",
                converter_output_placeholder: "DÃ¶nÃ¼ÅŸtÃ¼rÃ¼lmÃ¼ÅŸ BionicText'iniz burada gÃ¶rÃ¼necek...",
                converter_export_pdf: "PDF DÄ±ÅŸa Aktar",
                converter_export_txt: "TXT DÄ±ÅŸa Aktar",
                converter_speak: "ðŸ”Š Seslendir",
                converter_tts_options: "Metinden Sese SeÃ§enekleri",
                
                // Profile section
                profile_title: "KullanÄ±cÄ± Profili",
                profile_member_since: "Ãœyelik tarihi",
                profile_total_tests: "Toplam Test",
                
                // Profile menu
                profile_menu_profile: "Profilim",
                profile_menu_test: "Okuma Testi Yap",
                profile_menu_converter: "Metin DÃ¶nÃ¼ÅŸtÃ¼r",
                profile_menu_assistant: "AI Asistan",
                profile_menu_export: "Veri DÄ±ÅŸa Aktar",
                profile_menu_logout: "Ã‡Ä±kÄ±ÅŸ Yap",
                profile_reading_stats: "Okuma Ä°statistikleri",
                profile_avg_normal: "Ort. Normal HÄ±z (DKK)",
                profile_avg_bionic: "Ort. BionicText HÄ±zÄ± (DKK)",
                profile_avg_improvement: "Ortalama Ä°yileÅŸtirme",
                profile_best_improvement: "En Ä°yi Ä°yileÅŸtirme",
                profile_progress: "Okuma HÄ±zÄ± Ä°lerlemesi",
                profile_recent_tests: "Son Test SonuÃ§larÄ±",
                profile_no_tests: "HenÃ¼z test sonucu yok. Ä°lk okuma hÄ±zÄ± testinizi yapÄ±n!",
                profile_start_test: "Test BaÅŸlat",
                profile_achievements: "BaÅŸarÄ±mlar",
                profile_first_test: "Ä°lk Test",
                profile_first_test_desc: "Ä°lk okuma testinizi tamamlayÄ±n",
                profile_speed_demon: "HÄ±z ÅžeytanÄ±",
                profile_speed_demon_desc: "BionicText ile 300+ DKK'ya ulaÅŸÄ±n",
                profile_consistent: "TutarlÄ± Okuyucu",
                profile_consistent_desc: "10 test tamamlayÄ±n",
                profile_quick_actions: "HÄ±zlÄ± Ä°ÅŸlemler",
                profile_take_test: "Yeni Test Al",
                profile_convert_text: "Metin DÃ¶nÃ¼ÅŸtÃ¼r",
                profile_export_data: "TÃ¼m Verileri DÄ±ÅŸa Aktar",
                profile_delete_data: "TÃ¼m Verileri Sil",
                
                // Notifications
                notif_login_success: "Tekrar hoÅŸ geldiniz! BaÅŸarÄ±yla giriÅŸ yaptÄ±nÄ±z.",
                notif_login_failed: "GiriÅŸ baÅŸarÄ±sÄ±z: ",
                notif_test_saved: "Test sonuÃ§larÄ± profilinize kaydedildi!",
                notif_signin_to_save: "Test sonuÃ§larÄ±nÄ±zÄ± kaydetmek iÃ§in giriÅŸ yapÄ±n!",
                notif_data_exported: "Test sonuÃ§larÄ± baÅŸarÄ±yla dÄ±ÅŸa aktarÄ±ldÄ±!",
                notif_data_deleted: "TÃ¼m veriler baÅŸarÄ±yla silindi",
                notif_no_data_export: "DÄ±ÅŸa aktarÄ±lacak test verisi yok. Ã–nce bazÄ± testler yapÄ±n!",
                notif_db_setup: "VeritabanÄ± hala kurulumu yapÄ±yor. Verileriniz gÃ¼vende - lÃ¼tfen bir dakika sonra yenilemeyi deneyin.",
                notif_permission_denied: "Ä°zin reddedildi. LÃ¼tfen Ã§Ä±kÄ±ÅŸ yapÄ±p tekrar giriÅŸ yapÄ±n.",
                notif_connection_issue: "GeÃ§ici baÄŸlantÄ± sorunu. Profiliniz hala mevcut.",
                
                // AI Assistant
                assistant_title: "AI Asistan",
                assistant_subtitle: "BionicText, okuma teknikleri veya kiÅŸisel okuma verileriniz hakkÄ±nda her ÅŸeyi sorabilirsiniz!",
                assistant_name: "BionicText AI Asistan",
                assistant_status: "Ã‡evrimiÃ§i â€¢ YardÄ±ma hazÄ±r",
                assistant_welcome: "Merhaba! Ben BionicText AI AsistanÄ±nÄ±zÄ±m. Size ÅŸunlarda yardÄ±mcÄ± olabilirim:",
                assistant_help_1: "â€¢ BionicText ve hÄ±zlÄ± okuma hakkÄ±nda sorular",
                assistant_help_2: "â€¢ Okuma performansÄ±nÄ±zÄ±n analizi",
                assistant_help_3: "â€¢ Okuma hÄ±zÄ±nÄ±zÄ± artÄ±rma ipuÃ§larÄ±",
                assistant_help_4: "â€¢ Her konuda genel sorular!",
                assistant_ask: "Ne Ã¶ÄŸrenmek istersiniz?",
                assistant_input_placeholder: "MesajÄ±nÄ±zÄ± yazÄ±n...",
                assistant_send: "GÃ¶nder",
                assistant_feature_1: "AkÄ±llÄ± Analiz",
                assistant_feature_1_desc: "Okuma kalÄ±plarÄ±nÄ±z ve performans trendleriniz hakkÄ±nda iÃ§gÃ¶rÃ¼ler edinin",
                assistant_feature_2: "KiÅŸiselleÅŸtirilmiÅŸ Ä°puÃ§larÄ±",
                assistant_feature_2_desc: "Okuma verilerinize ve hedeflerinize gÃ¶re Ã¶zelleÅŸtirilmiÅŸ tavsiyeler alÄ±n",
                assistant_feature_3: "7/24 Destek",
                assistant_feature_3_desc: "Okuma teknikleri ve BionicText hakkÄ±nda istediÄŸiniz zaman soru sorun",
                quick_what_bionic: "BionicText nedir?",
                quick_improve_speed: "Okuma hÄ±zÄ±nÄ± artÄ±r",
                quick_my_stats: "Ä°statistiklerim",
                quick_benefits: "HÄ±zlÄ± okuma faydalarÄ±"
            },
            
            it: {
                // Navigation
                nav_home: "Home",
                nav_test: "Test",
                nav_converter: "Convertitore",
                nav_assistant: "Assistente AI",
                nav_profile: "Profilo",
                nav_leaderboard: "Classifica",
                login: "Accedi",
                logout: "Esci",
                
                // Leaderboard
                leaderboard_title: "Classifica",
                leaderboard_info: "Utenti top per PPM medio BionicText",
                leaderboard_user: "Utente",
                leaderboard_avg_bionic: "Media BionicText (PPM)",
                leaderboard_tests: "Test",
                
                // Authentication
                auth_welcome: "Bentornato",
                auth_signin_subtitle: "Accedi al tuo account",
                auth_email: "Email",
                auth_password: "Password",
                auth_email_placeholder: "Inserisci la tua email",
                auth_password_placeholder: "Inserisci la tua password",
                auth_signin: "Accedi",
                auth_signup: "Registrati",
                auth_no_account: "Non hai un account? ",
                auth_create_account: "Crea Account",
                auth_signup_subtitle: "Registrati per un nuovo account",
                auth_have_account: "Hai giÃ  un account? ",
                
                // Home page
                home_subtitle: "Migliora la tua velocitÃ  di lettura e comprensione con la formattazione del testo basata su AI. Sperimenta il futuro della lettura efficiente.",
                home_start_test: "Inizia Test di Lettura",
                home_try_converter: "Prova Convertitore",
                home_speed_reading: "Lettura Veloce",
                home_speed_desc: "Aumenta la tua velocitÃ  di lettura fino al 200% con il nostro formato BionicText scientificamente supportato.",
                home_comprehension: "Migliore Comprensione",
                home_comprehension_desc: "Mantieni o migliora la comprensione mentre leggi piÃ¹ velocemente attraverso la formattazione del testo migliorata.",
                home_multi_format: "Supporto Multi-Formato",
                home_multi_format_desc: "Converti testo, PDF e persino parlato in formato BionicText con i nostri strumenti AI avanzati.",
                
                // Test section
                test_title: "Test di VelocitÃ  di Lettura",
                test_subtitle: "Confronta la tua velocitÃ  di lettura con testo normale vs. formato BionicText",
                test_step1: "Passo 1: Lettura Testo Normale",
                test_step2: "Passo 2: Lettura BionicText",
                test_start_timer: "Avvia Timer",
                test_finish_timer: "Termina Timer",
                test_results_title: "I Tuoi Risultati di VelocitÃ  di Lettura",
                test_normal_text: "Testo Normale",
                test_bionic_text: "BionicText",
                test_wpm: "parole al minuto",
                test_improvement: "Miglioramento VelocitÃ ",
                test_download_report: "Scarica Report PDF",
                test_take_again: "Rifai il Test",
                
                // Converter section
                converter_title: "Convertitore BionicText",
                converter_subtitle: "Trasforma qualsiasi testo in formato BionicText per una velocitÃ  di lettura migliorata",
                converter_input_text: "Testo di Input",
                converter_text_input: "Input Testo",
                converter_file_upload: "Caricamento File",
                converter_voice_input: "Input Vocale",
                converter_paste_text: "Incolla il tuo testo qui o inizia a digitare...",
                converter_drop_file: "Trascina il tuo file PDF o TXT qui",
                converter_click_browse: "o clicca per sfogliare",
                converter_choose_file: "Scegli File",
                converter_click_record: "Clicca per iniziare la registrazione",
                converter_speak_clearly: "Parla chiaramente per i migliori risultati",
                converter_recording: "Registrando... Clicca per fermare",
                converter_convert: "Converti in BionicText",
                converter_output: "Output BionicText",
                converter_output_placeholder: "Il tuo BionicText convertito apparirÃ  qui...",
                converter_export_pdf: "Esporta PDF",
                converter_export_txt: "Esporta TXT",
                converter_speak: "ðŸ”Š Parla",
                converter_tts_options: "Opzioni Text-to-Speech",
                
                // Profile section
                profile_title: "Profilo Utente",
                profile_member_since: "Membro dal",
                profile_total_tests: "Test Totali",
                
                // Profile menu
                profile_menu_profile: "Il Mio Profilo",
                profile_menu_test: "Fai Test di Lettura",
                profile_menu_converter: "Converti Testo",
                profile_menu_assistant: "Assistente AI",
                profile_menu_export: "Esporta Dati",
                profile_menu_logout: "Esci",
                profile_reading_stats: "Statistiche di Lettura",
                profile_avg_normal: "VelocitÃ  Media Normale (PPM)",
                profile_avg_bionic: "VelocitÃ  Media BionicText (PPM)",
                profile_avg_improvement: "Miglioramento Medio",
                profile_best_improvement: "Miglior Miglioramento",
                profile_progress: "Progresso VelocitÃ  di Lettura",
                profile_recent_tests: "Risultati Test Recenti",
                profile_no_tests: "Nessun risultato test ancora. Fai il tuo primo test di velocitÃ  di lettura!",
                profile_start_test: "Inizia Test",
                profile_achievements: "Risultati",
                profile_first_test: "Primo Test",
                profile_first_test_desc: "Completa il tuo primo test di lettura",
                profile_speed_demon: "Demone della VelocitÃ ",
                profile_speed_demon_desc: "Raggiungi 300+ PPM con BionicText",
                profile_consistent: "Lettore Costante",
                profile_consistent_desc: "Completa 10 test",
                profile_quick_actions: "Azioni Rapide",
                profile_take_test: "Nuovo Test",
                profile_convert_text: "Converti Testo",
                profile_export_data: "Esporta Tutti i Dati",
                profile_delete_data: "Elimina Tutti i Dati",
                
                // Notifications
                notif_login_success: "Bentornato! Accesso effettuato con successo.",
                notif_login_failed: "Accesso fallito: ",
                notif_test_saved: "Risultati del test salvati nel tuo profilo!",
                notif_signin_to_save: "Accedi per salvare i risultati del test!",
                notif_data_exported: "Risultati del test esportati con successo!",
                notif_data_deleted: "Tutti i dati eliminati con successo",
                notif_no_data_export: "Nessun dato test da esportare. Fai prima alcuni test!",
                notif_db_setup: "Il database si sta ancora configurando. I tuoi dati sono al sicuro - prova ad aggiornare tra un momento.",
                notif_permission_denied: "Permesso negato. Esci e accedi di nuovo.",
                notif_connection_issue: "Problema di connessione temporaneo. Il tuo profilo Ã¨ ancora disponibile.",
                
                // AI Assistant
                assistant_title: "Assistente AI",
                assistant_subtitle: "Chiedimi qualsiasi cosa su BionicText, tecniche di lettura o i tuoi dati di lettura personali!",
                assistant_name: "Assistente AI BionicText",
                assistant_status: "Online â€¢ Pronto ad aiutare",
                assistant_welcome: "Ciao! Sono il tuo Assistente AI BionicText. Posso aiutarti con:",
                assistant_help_1: "â€¢ Domande su BionicText e lettura veloce",
                assistant_help_2: "â€¢ Analisi delle tue prestazioni di lettura",
                assistant_help_3: "â€¢ Consigli per migliorare la velocitÃ  di lettura",
                assistant_help_4: "â€¢ Domande generali su qualsiasi argomento!",
                assistant_ask: "Cosa vorresti sapere?",
                assistant_input_placeholder: "Scrivi il tuo messaggio...",
                assistant_send: "Invia",
                assistant_feature_1: "Analisi Intelligente",
                assistant_feature_1_desc: "Ottieni informazioni sui tuoi modelli di lettura e tendenze delle prestazioni",
                assistant_feature_2: "Consigli Personalizzati",
                assistant_feature_2_desc: "Ricevi consigli personalizzati basati sui tuoi dati di lettura e obiettivi",
                assistant_feature_3: "Supporto 24/7",
                assistant_feature_3_desc: "Fai domande in qualsiasi momento su tecniche di lettura e BionicText",
                quick_what_bionic: "Cos'Ã¨ BionicText?",
                quick_improve_speed: "Migliora velocitÃ  lettura",
                quick_my_stats: "Le mie statistiche",
                quick_benefits: "Benefici lettura veloce"
            }
        };

        // Ayarlar iÃ§in global deÄŸiÅŸkenler
let currentSettings = {
    font: 'inter',
    lineHeight: 1.5,
    wordSpacing: 0.1,
    letterSpacing: 0.05,
    fontSize: 16,
    bgColor: '#f9fafb',
    textColor: '#1a2b4c',
    primaryColor: '#1a2b4c',
    linkColor: '#2563eb'
};

// Font deÄŸiÅŸtirme
function changeFont(fontType) {
    const fontMap = {
        'opendyslexic': 'OpenDyslexic, sans-serif',
        'comic-sans': '"Comic Sans MS", cursive',
        'arial': 'Arial, sans-serif',
        'verdana': 'Verdana, sans-serif',
        'inter': 'Inter, sans-serif'
    };

    currentSettings.font = fontType;
    document.documentElement.style.setProperty('--font-family', fontMap[fontType]);
    updatePreview();
}

// SatÄ±r aralÄ±ÄŸÄ± deÄŸiÅŸtirme
function changeLineHeight(value) {
    currentSettings.lineHeight = parseFloat(value);
    document.getElementById('lineHeightValue').textContent = value;
    document.documentElement.style.setProperty('--line-height', value);
    updatePreview();
}

// Kelime aralÄ±ÄŸÄ± deÄŸiÅŸtirme
function changeWordSpacing(value) {
    currentSettings.wordSpacing = parseFloat(value);
    document.getElementById('wordSpacingValue').textContent = value;
    document.documentElement.style.setProperty('--word-spacing', value + 'rem');
    updatePreview();
}

// Harf aralÄ±ÄŸÄ± deÄŸiÅŸtirme
function changeLetterSpacing(value) {
    currentSettings.letterSpacing = parseFloat(value);
    document.getElementById('letterSpacingValue').textContent = value;
    document.documentElement.style.setProperty('--letter-spacing', value + 'rem');
    updatePreview();
}

// YazÄ± boyutu deÄŸiÅŸtirme
function changeFontSize(value) {
    currentSettings.fontSize = parseInt(value);
    document.getElementById('fontSizeValue').textContent = value;
    document.documentElement.style.setProperty('--font-size', value + 'px');
    updatePreview();
}

// Renk deÄŸiÅŸtirme fonksiyonlarÄ±
function changeBackgroundColor(color) {
    currentSettings.bgColor = color;
    document.documentElement.style.setProperty('--bg-color', color);
    updatePreview();
}

function changeTextColor(color) {
    currentSettings.textColor = color;
    document.documentElement.style.setProperty('--text-color', color);
    updatePreview();
}

function changePrimaryColor(color) {
    currentSettings.primaryColor = color;
    document.documentElement.style.setProperty('--primary-color', color);
    updatePreview();
}

function changeLinkColor(color) {
    currentSettings.linkColor = color;
    document.documentElement.style.setProperty('--link-color', color);
    updatePreview();
}

// Ã–nizleme gÃ¼ncelleme
function updatePreview() {
    const preview = document.getElementById('previewText');
    if (preview) {
        preview.style.fontFamily = `var(--font-family, Inter)`;
        preview.style.lineHeight = `var(--line-height, 1.5)`;
        preview.style.wordSpacing = `var(--word-spacing, 0.1rem)`;
        preview.style.letterSpacing = `var(--letter-spacing, 0.05rem)`;
        preview.style.fontSize = `var(--font-size, 16px)`;
        preview.style.color = `var(--text-color, #1a2b4c)`;
    }
}

// AyarlarÄ± sÄ±fÄ±rlama
function resetSettings() {
    currentSettings = {
        font: 'inter',
        lineHeight: 1.5,
        wordSpacing: 0.1,
        letterSpacing: 0.05,
        fontSize: 16,
        bgColor: '#f9fafb',
        textColor: '#1a2b4c',
        primaryColor: '#1a2b4c',
        linkColor: '#2563eb'
    };

    // SliderlarÄ± sÄ±fÄ±rla
    document.getElementById('lineHeightSlider').value = 1.5;
    document.getElementById('wordSpacingSlider').value = 0.1;
    document.getElementById('letterSpacingSlider').value = 0.05;
    document.getElementById('fontSizeSlider').value = 16;

    // DeÄŸerleri gÃ¶ster
    document.getElementById('lineHeightValue').textContent = '1.5';
    document.getElementById('wordSpacingValue').textContent = '0.1';
    document.getElementById('letterSpacingValue').textContent = '0.05';
    document.getElementById('fontSizeValue').textContent = '16';

    // Renk pickerlarÄ± sÄ±fÄ±rla
    document.getElementById('bgColorPicker').value = '#f9fafb';
    document.getElementById('textColorPicker').value = '#1a2b4c';
    document.getElementById('primaryColorPicker').value = '#1a2b4c';
    document.getElementById('linkColorPicker').value = '#2563eb';

    // CSS deÄŸiÅŸkenlerini sÄ±fÄ±rla
    const root = document.documentElement;
    root.style.removeProperty('--font-family');
    root.style.removeProperty('--line-height');
    root.style.removeProperty('--word-spacing');
    root.style.removeProperty('--letter-spacing');
    root.style.removeProperty('--font-size');
    root.style.removeProperty('--bg-color');
    root.style.removeProperty('--text-color');
    root.style.removeProperty('--primary-color');
    root.style.removeProperty('--link-color');

    updatePreview();
    showNotification('Ayarlar sÄ±fÄ±rlandÄ±', 'success');
}

// AyarlarÄ± kaydetme
function saveSettings() {
    localStorage.setItem('bionictext_settings', JSON.stringify(currentSettings));
    applySettings();
    showNotification('Ayarlar kaydedildi', 'success');
}

// AyarlarÄ± uygulama
function applySettings() {
    const savedSettings = localStorage.getItem('bionictext_settings');
    if (savedSettings) {
        currentSettings = JSON.parse(savedSettings);
        
        const root = document.documentElement;
        const fontMap = {
            'opendyslexic': 'OpenDyslexic, sans-serif',
            'comic-sans': '"Comic Sans MS", cursive',
            'arial': 'Arial, sans-serif',
            'verdana': 'Verdana, sans-serif',
            'inter': 'Inter, sans-serif'
        };

        root.style.setProperty('--font-family', fontMap[currentSettings.font]);
        root.style.setProperty('--line-height', currentSettings.lineHeight);
        root.style.setProperty('--word-spacing', currentSettings.wordSpacing + 'rem');
        root.style.setProperty('--letter-spacing', currentSettings.letterSpacing + 'rem');
        root.style.setProperty('--font-size', currentSettings.fontSize + 'px');
        root.style.setProperty('--bg-color', currentSettings.bgColor);
        root.style.setProperty('--text-color', currentSettings.textColor);
        root.style.setProperty('--primary-color', currentSettings.primaryColor);
        root.style.setProperty('--link-color', currentSettings.linkColor);
    }
}

// Sayfa yÃ¼klendiÄŸinde ayarlarÄ± uygula
document.addEventListener('DOMContentLoaded', function() {
    applySettings();
    
    // GÃ¶rev state yÃ¶netimini baÅŸlat
    initializeAchievementStates();
    
    // Ä°lk giriÅŸ kontrolÃ¼
    if (!localStorage.getItem('firstLoginChecked')) {
        updateAchievementState('firstLogin', true);
        localStorage.setItem('firstLoginChecked', 'true');
    }
    
    // Achievements sayfalama event listener'larÄ±nÄ± ekle
    const prevBtn = document.getElementById('prevAchievements');
    const nextBtn = document.getElementById('nextAchievements');
    
    
});

        // Translation functions
        function changeLanguage() {
            const selectedLang = document.getElementById('languageSelector').value;
            currentLanguage = selectedLang;
            localStorage.setItem('bionictext_language', selectedLang);
            translatePage();
        }

        function translatePage() {
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });

            // Handle placeholders
            const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
            placeholderElements.forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.placeholder = translations[currentLanguage][key];
                }
            });

            // Update voice language selector
            updateVoiceLanguageOptions();
        }

        function updateVoiceLanguageOptions() {
            const voiceSelect = document.getElementById('voiceLanguage');
            if (voiceSelect) {
                voiceSelect.innerHTML = '';
                
                const languageOptions = {
                    'en': [
                        { value: 'en-US', label: 'English (US)' },
                        { value: 'en-GB', label: 'English (UK)' }
                    ],
                    'tr': [
                        { value: 'tr-TR', label: 'TÃ¼rkÃ§e' },
                        { value: 'en-US', label: 'English (US)' }
                    ],
                    'it': [
                        { value: 'it-IT', label: 'Italiano' },
                        { value: 'en-US', label: 'English (US)' }
                    ]
                };
                
                const options = languageOptions[currentLanguage] || languageOptions['en'];
                options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option.value;
                    optionElement.textContent = option.label;
                    voiceSelect.appendChild(optionElement);
                });
            }
        }

        function initializeLanguage() {
            const savedLang = localStorage.getItem('bionictext_language') || 'tr';
            currentLanguage = savedLang;
            document.getElementById('languageSelector').value = savedLang;
            translatePage();
        }

        // Navigation
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            document.getElementById(section + 'Section').classList.add('fade-in');
            
            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-white', 'bg-blue-700');
                btn.classList.add('text-gray-300');
            });
            
            // Highlight active nav button (desktop)
            const buttons = Array.from(document.querySelectorAll('.nav-btn'));
            const activeBtn = buttons.find(b => b.getAttribute('onclick') && b.getAttribute('onclick').includes(`showSection('${section}')`));
            if (activeBtn) {
                activeBtn.classList.remove('text-gray-300');
                activeBtn.classList.add('text-white', 'bg-blue-700');
            }
            
            currentSection = section;

            // Close mobile menu if open
            const mm = document.getElementById('mobileMenu');
            if (mm && !mm.classList.contains('hidden')) mm.classList.add('hidden');
            
            // If switching to profile and user is logged in, refresh profile data
            if (section === 'profile' && window.firebaseAuth && window.firebaseAuth.currentUser) {
                console.log('Refreshing profile data for section change');
                updateProfileUI([]);
                loadUserStats();
            }
            if (section === 'leaderboard') {
                try { if (typeof loadLeaderboard === 'function') loadLeaderboard(); } catch (e) { console.warn('Leaderboard load skipped', e); }
            }
        }

        // Authentication
        function showAuth() {
            document.getElementById('authModal').classList.remove('hidden');
        }

        function closeAuth() {
            document.getElementById('authModal').classList.add('hidden');
        }

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            passwordInput.type = passwordInput.type === 'password' ? 'text' : 'password';
        }

        function toggleAuthMode() {
    // Toggle between login and register modes
    const title = document.querySelector('#authModal h2');
    const subtitle = document.querySelector('#authModal p');
    const button = document.querySelector('#authModal button[onclick="login()"]');
    const toggleText = document.getElementById('authToggleText'); // ID ile seÃ§im
    
    if (title.getAttribute('data-translate') === 'auth_welcome') {
        title.setAttribute('data-translate', 'auth_create_account');
        subtitle.setAttribute('data-translate', 'auth_signup_subtitle');
        button.setAttribute('data-translate', 'auth_signup');
        button.setAttribute('onclick', 'register()');
        
        // ID ile elemente eriÅŸerek gÃ¼venli ÅŸekilde iÃ§eriÄŸi deÄŸiÅŸtir
        if (toggleText) {
            toggleText.innerHTML = `<span class="text-gray-600" data-translate="auth_have_account">${translations[currentLanguage].auth_have_account}</span><button onclick="toggleAuthMode()" class="text-primary font-medium hover:underline" data-translate="auth_signin">${translations[currentLanguage].auth_signin}</button>`;
        }
    } else {
        title.setAttribute('data-translate', 'auth_welcome');
        subtitle.setAttribute('data-translate', 'auth_signin_subtitle');
        button.setAttribute('data-translate', 'auth_signin');
        button.setAttribute('onclick', 'login()');
        
        // ID ile elemente eriÅŸerek gÃ¼venli ÅŸekilde iÃ§eriÄŸi deÄŸiÅŸtir
        if (toggleText) {
            toggleText.innerHTML = `<span class="text-gray-600" data-translate="auth_no_account">${translations[currentLanguage].auth_no_account}</span><button onclick="toggleAuthMode()" class="text-primary font-medium hover:underline" data-translate="auth_signup">${translations[currentLanguage].auth_signup}</button>`;
        }
    }
    
    // Apply translations immediately
    translatePage();
}

        async function login() {
            const email = document.querySelector('#authModal input[type="email"]').value;
            const password = document.querySelector('#authModal input[type="password"]').value;
            
            if (!email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            try {
                console.log('Attempting login with:', email);
                const userCredential = await window.firebaseServices.signInWithEmailAndPassword(window.firebaseAuth, email, password);
                console.log('User signed in successfully:', userCredential.user);
                showNotification(translations[currentLanguage].notif_login_success, 'success');
                closeAuth();
                
                // Clear form
                document.querySelector('#authModal input[type="email"]').value = '';
                document.querySelector('#authModal input[type="password"]').value = '';
            } catch (error) {
                console.error('Login error:', error);
                showNotification(translations[currentLanguage].notif_login_failed + error.message, 'error');
            }
        }

        async function register() {
            const email = document.querySelector('#authModal input[type="email"]').value;
            const password = document.querySelector('#authModal input[type="password"]').value;
            
            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters long');
                return;
            }
            
            try {
                const userCredential = await window.firebaseServices.createUserWithEmailAndPassword(window.firebaseAuth, email, password);
                console.log('User registered:', userCredential.user);
                closeAuth();
            } catch (error) {
                console.error('Registration error:', error);
                alert('Registration failed: ' + error.message);
            }
        }

        async function logout() {
            try {
                await window.firebaseServices.signOut(window.firebaseAuth);
                console.log('User signed out');
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // Reading Speed Test
        function startTimer(step) {
            testStartTimes[step] = Date.now();
            document.getElementById(`startBtn${step}`).disabled = true;
            document.getElementById(`finishBtn${step}`).disabled = false;
            
            testTimers[step] = setInterval(() => {
                const elapsed = Math.floor((Date.now() - testStartTimes[step]) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById(`timer${step}`).textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function finishTimer(step) {
            clearInterval(testTimers[step]);
            const elapsed = (Date.now() - testStartTimes[step]) / 1000;
            const wordCount = currentWordCount || 150; // Use current word count or default
            const wpm = Math.round((wordCount / elapsed) * 60);
            
            if (step === 1) {
                testResults.normal = wpm;
                // Generate BionicText version for step 2
                generateBionicTestText();
                document.getElementById('testStep2').classList.remove('hidden');
                document.getElementById('testStep1').style.opacity = '0.6';
            } else {
                testResults.bionic = wpm;
                showTestResults();
            }
            
            document.getElementById(`startBtn${step}`).disabled = false;
            document.getElementById(`finishBtn${step}`).disabled = true;
        }

        // Test text management functions
        function setTestTextMode(mode) {
            // Hide all test text modes
            document.querySelectorAll('.test-text-mode').forEach(m => m.classList.add('hidden'));
            
            // Show selected mode
            document.getElementById(mode + 'TextMode').classList.remove('hidden');
            
            // Update buttons
            document.querySelectorAll('.test-text-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            event.target.classList.remove('bg-gray-200', 'text-gray-700');
            event.target.classList.add('bg-primary', 'text-white');

            // Load appropriate text
            if (mode === 'preset') {
                loadPresetText();
            }
        }

        function loadPresetText() {
            const selectedValue = document.getElementById('presetTextSelect').value;
            const presetTexts = {
                ai: {
                    en: "The rapid advancement of artificial intelligence has transformed numerous industries and aspects of daily life. From healthcare diagnostics to autonomous vehicles, AI systems are becoming increasingly sophisticated and capable. Machine learning algorithms can now process vast amounts of data to identify patterns and make predictions with remarkable accuracy. Natural language processing has enabled computers to understand and generate human-like text, revolutionizing communication and content creation. As we continue to develop these technologies, it becomes crucial to consider their ethical implications and ensure they benefit society as a whole. The future of AI holds immense potential for solving complex global challenges, but it also requires careful consideration of privacy, security, and the impact on employment markets.",
                    tr: "Yapay zekanÄ±n hÄ±zlÄ± ilerlemesi, sayÄ±sÄ±z endÃ¼striyi ve gÃ¼nlÃ¼k yaÅŸamÄ±n birÃ§ok yÃ¶nÃ¼nÃ¼ dÃ¶nÃ¼ÅŸtÃ¼rdÃ¼. SaÄŸlÄ±k teÅŸhislerinden otonom araÃ§lara kadar, AI sistemleri giderek daha sofistike ve yetenekli hale geliyor. Makine Ã¶ÄŸrenmesi algoritmalarÄ± artÄ±k bÃ¼yÃ¼k miktarlarda veriyi iÅŸleyerek kalÄ±plarÄ± tanÄ±mlayabilir ve olaÄŸanÃ¼stÃ¼ doÄŸrulukla tahminler yapabilir. DoÄŸal dil iÅŸleme, bilgisayarlarÄ±n insan benzeri metinleri anlamasÄ±nÄ± ve Ã¼retmesini saÄŸlayarak iletiÅŸim ve iÃ§erik oluÅŸturmada devrim yarattÄ±. Bu teknolojileri geliÅŸtirmeye devam ederken, etik sonuÃ§larÄ±nÄ± dÃ¼ÅŸÃ¼nmek ve toplumun tamamÄ±na fayda saÄŸlamalarÄ±nÄ± garanti etmek kritik hale geliyor."
                },
                science: {
                    en: "The human brain contains approximately 86 billion neurons, each connected to thousands of others through synapses. This intricate network processes information at incredible speeds, allowing us to think, feel, and react to our environment. Recent neuroscience research has revealed fascinating insights about neuroplasticity - the brain's ability to reorganize and form new neural connections throughout life. This discovery has revolutionized our understanding of learning, memory, and recovery from brain injuries. Scientists now know that engaging in challenging mental activities, physical exercise, and social interactions can promote the growth of new neural pathways, enhancing cognitive function and potentially protecting against age-related decline.",
                    tr: "Ä°nsan beyni yaklaÅŸÄ±k 86 milyar nÃ¶ron iÃ§erir ve her biri sinapslar aracÄ±lÄ±ÄŸÄ±yla binlerce diÄŸeriyle baÄŸlÄ±dÄ±r. Bu karmaÅŸÄ±k aÄŸ, inanÄ±lmaz hÄ±zlarda bilgi iÅŸleyerek dÃ¼ÅŸÃ¼nmemizi, hissetmemizi ve Ã§evremize tepki vermemizi saÄŸlar. Son nÃ¶robilim araÅŸtÄ±rmalarÄ±, nÃ¶roplastisite hakkÄ±nda bÃ¼yÃ¼leyici iÃ§gÃ¶rÃ¼ler ortaya Ã§Ä±kardÄ± - beynin yaÅŸam boyunca yeniden organize olma ve yeni sinir baÄŸlantÄ±larÄ± kurma yeteneÄŸi. Bu keÅŸif, Ã¶ÄŸrenme, hafÄ±za ve beyin yaralanmalarÄ±ndan iyileÅŸme anlayÄ±ÅŸÄ±mÄ±zda devrim yarattÄ±. Bilim insanlarÄ± artÄ±k zihinsel olarak zorlayÄ±cÄ± aktivitelere katÄ±lmanÄ±n, fiziksel egzersiz yapmanÄ±n ve sosyal etkileÅŸimlerin yeni sinir yollarÄ±nÄ±n bÃ¼yÃ¼mesini teÅŸvik edebileceÄŸini biliyor."
                },
                history: {
                    en: "The Renaissance period, spanning roughly from the 14th to the 17th century, marked a profound transformation in European culture, art, politics, and science. This era witnessed the revival of classical learning and wisdom after the Middle Ages, leading to unprecedented achievements in various fields. Artists like Leonardo da Vinci and Michelangelo created masterpieces that continue to inspire people today. Scientists such as Galileo Galilei and Nicolaus Copernicus revolutionized our understanding of the universe. The invention of the printing press by Johannes Gutenberg democratized knowledge, making books more accessible and accelerating the spread of ideas across Europe. This period laid the foundation for the modern world and continues to influence contemporary thought and culture.",
                    tr: "YaklaÅŸÄ±k 14. yÃ¼zyÄ±ldan 17. yÃ¼zyÄ±la kadar uzanan RÃ¶nesans dÃ¶nemi, Avrupa kÃ¼ltÃ¼rÃ¼, sanatÄ±, politikasÄ± ve biliminde derin bir dÃ¶nÃ¼ÅŸÃ¼mÃ¼ iÅŸaret etti. Bu Ã§aÄŸ, Orta Ã‡aÄŸ'dan sonra klasik Ã¶ÄŸrenme ve bilgeliÄŸin yeniden canlanmasÄ±na tanÄ±k oldu ve Ã§eÅŸitli alanlarda eÅŸi gÃ¶rÃ¼lmemiÅŸ baÅŸarÄ±lara yol aÃ§tÄ±. Leonardo da Vinci ve Michelangelo gibi sanatÃ§Ä±lar, bugÃ¼n hala insanlara ilham veren baÅŸyapÄ±tlar yarattÄ±. Galileo Galilei ve Nicolaus Copernicus gibi bilim insanlarÄ± evren anlayÄ±ÅŸÄ±mÄ±zda devrim yarattÄ±. Johannes Gutenberg'in matbaayÄ± icat etmesi bilgiyi demokratikleÅŸtirdi, kitaplarÄ± daha eriÅŸilebilir hale getirdi ve fikirlerin Avrupa'da yayÄ±lmasÄ±nÄ± hÄ±zlandÄ±rdÄ±."
                },
                literature: {
                    en: "Literature has the unique power to transport readers across time and space, offering glimpses into different cultures, perspectives, and human experiences. Through the written word, authors can explore complex themes such as love, loss, identity, and the human condition. Classic works like Shakespeare's plays, Dickens' novels, and Austen's social commentaries continue to resonate with modern audiences because they address universal truths about human nature. Contemporary literature builds upon this foundation, incorporating diverse voices and modern concerns while maintaining the fundamental goal of storytelling: to connect with readers on an emotional and intellectual level. Reading literature not only entertains but also develops empathy, critical thinking skills, and cultural awareness.",
                    tr: "Edebiyat, okuyucularÄ± zaman ve mekanda taÅŸÄ±yarak farklÄ± kÃ¼ltÃ¼rlere, bakÄ±ÅŸ aÃ§Ä±larÄ±na ve insan deneyimlerine dair gÃ¶rÃ¼ntÃ¼ler sunma konusunda eÅŸsiz bir gÃ¼ce sahiptir. YazÄ±lÄ± kelime aracÄ±lÄ±ÄŸÄ±yla yazarlar aÅŸk, kayÄ±p, kimlik ve insanlÄ±k durumu gibi karmaÅŸÄ±k temalarÄ± keÅŸfedebilir. Shakespeare'in oyunlarÄ±, Dickens'Ä±n romanlarÄ± ve Austen'Ä±n sosyal yorumlarÄ± gibi klasik eserler, insan doÄŸasÄ± hakkÄ±ndaki evrensel gerÃ§ekleri ele aldÄ±klarÄ± iÃ§in modern izleyicilerle yankÄ±lanmaya devam ediyor. Ã‡aÄŸdaÅŸ edebiyat bu temelin Ã¼zerine inÅŸa ederek Ã§eÅŸitli sesleri ve modern kaygÄ±larÄ± dahil ederken hikaye anlatÄ±mÄ±nÄ±n temel amacÄ±nÄ± korur: okuyucularla duygusal ve entelektÃ¼el dÃ¼zeyde baÄŸlantÄ± kurmak."
                }
            };

            const text = presetTexts[selectedValue][currentLanguage] || presetTexts[selectedValue]['en'];
            document.getElementById('testText1').textContent = text;
            currentTestText = text;
            currentWordCount = text.split(/\s+/).length;
        }

        function loadCustomText() {
            const customText = document.getElementById('customTestText').value.trim();
            if (!customText) {
                alert(currentLanguage === 'tr' ? 'LÃ¼tfen Ã¶zel metninizi girin.' : 'Please enter your custom text.');
                return;
            }

            if (customText.split(/\s+/).length < 50) {
                alert(currentLanguage === 'tr' ? 'Metin Ã§ok kÄ±sa. En az 50 kelime girin.' : 'Text is too short. Please enter at least 50 words.');
                return;
            }

            document.getElementById('customDisplayText').textContent = customText;
            document.getElementById('customTextDisplay').classList.remove('hidden');
            currentTestText = customText;
            currentWordCount = customText.split(/\s+/).length;
        }

        function generateBionicTestText() {
            const bionicText = convertToBionic(currentTestText);
            document.getElementById('testText2').innerHTML = bionicText;
        }

        // Update word count for custom text
        document.addEventListener('DOMContentLoaded', function() {
            const customTextArea = document.getElementById('customTestText');
            if (customTextArea) {
                customTextArea.addEventListener('input', function() {
                    const wordCount = this.value.trim().split(/\s+/).filter(word => word.length > 0).length;
                    document.getElementById('customWordCount').textContent = wordCount;
                });
            }
        });

        async function showTestResults() {
            document.getElementById('testResults').classList.remove('hidden');
            document.getElementById('normalWPM').textContent = testResults.normal;
            document.getElementById('bionicWPM').textContent = testResults.bionic;
            
            const improvement = ((testResults.bionic - testResults.normal) / testResults.normal * 100);
            const improvementText = improvement > 0 ? `+${improvement.toFixed(1)}%` : `${improvement.toFixed(1)}%`;
            document.getElementById('improvement').textContent = improvementText;
            
            const progressWidth = Math.min(Math.abs(improvement), 100);
            document.getElementById('progressBar').style.width = `${progressWidth}%`;
            
            if (improvement > 0) {
                document.getElementById('progressBar').classList.add('bg-green-500');
                document.getElementById('improvement').classList.add('text-green-600');
            } else {
                document.getElementById('progressBar').classList.add('bg-red-500');
                document.getElementById('improvement').classList.add('text-red-600');
            }
            
            // Save test results to Firebase if user is logged in
            if (window.firebaseAuth.currentUser) {
                const testData = {
                    normalWPM: testResults.normal,
                    bionicWPM: testResults.bionic,
                    improvement: improvement,
                    testDate: new Date().toISOString(),
                    timestamp: window.firebaseServices.serverTimestamp()
                };
                
                await saveTestResults(testData);
                
                // Show success message
                showNotification('Test results saved to your profile!', 'success');
                
                // Refresh user stats if on profile page
                if (currentSection === 'profile') {
                    await loadUserStats();
                }
            } else {
                showNotification('Sign in to save your test results!', 'info');
            }
        }

        async function saveTestResults(results) {
            try {
                const testData = {
                    userId: window.firebaseAuth.currentUser.uid,
                    userEmail: window.firebaseAuth.currentUser.email,
                    normalWPM: results.normalWPM,
                    bionicWPM: results.bionicWPM,
                    improvement: results.improvement,
                    testDate: results.testDate,
                    timestamp: window.firebaseServices.serverTimestamp(),
                    createdAt: new Date().toISOString()
                };
                
                console.log('Saving test data:', testData);
                
                const docRef = await window.firebaseServices.addDoc(
                    window.firebaseServices.collection(window.firebaseDb, 'testResults'), 
                    testData
                );
                console.log('Test results saved with ID: ', docRef.id);
                
                // Test tamamlama gÃ¶revlerini tetikle
                triggerTestAchievements(results);
                
                return docRef.id;
            } catch (error) {
                console.error('Error saving test results: ', error);
                showNotification('Failed to save test results: ' + error.message, 'error');
                throw error;
            }
        }

        // Test tamamlama gÃ¶revlerini tetikle
        function triggerTestAchievements(results) {
            // Ã–zel metin kullanÄ±mÄ± kontrolÃ¼
            if (results.customTextUsed) {
                updateAchievementState('customText', true);
            }
            
            // PDF indirme kontrolÃ¼ (test sonuÃ§larÄ± indirildiÄŸinde)
            if (results.downloadedAsPDF) {
                updateAchievementState('pdfDownload', true);
            }
            
            // Kelime sayÄ±sÄ± takibi (global state'e ekle)
            const totalWords = parseInt(localStorage.getItem('totalWordsRead') || '0');
            const newTotal = totalWords + results.wordCount;
            localStorage.setItem('totalWordsRead', newTotal.toString());
            
            // Kelime bazlÄ± gÃ¶revler
            if (newTotal >= 1000) {
                updateAchievementState('1000Words', true);
            }
            if (newTotal >= 5000) {
                updateAchievementState('5000Words', true);
            }
            if (newTotal >= 10000) {
                updateAchievementState('10000Words', true);
            }
        }

        function resetTest() {
            document.getElementById('testStep1').style.opacity = '1';
            document.getElementById('testStep2').classList.add('hidden');
            document.getElementById('testResults').classList.add('hidden');
            
            // Reset timers
            document.getElementById('timer1').textContent = '00:00';
            document.getElementById('timer2').textContent = '00:00';
            
            // Reset buttons
            document.querySelectorAll('[id^="startBtn"]').forEach(btn => btn.disabled = false);
            document.querySelectorAll('[id^="finishBtn"]').forEach(btn => btn.disabled = true);
            
            testResults = { normal: 0, bionic: 0 };
        }

        function downloadResults() {
            // Simulate PDF download
            const results = `Reading Speed Test Results
            
Normal Text Speed: ${testResults.normal} WPM
BionicText Speed: ${testResults.bionic} WPM
Improvement: ${document.getElementById('improvement').textContent}

Generated by BionicText AI - ${new Date().toLocaleDateString()}`;
            
            const blob = new Blob([results], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'reading-speed-results.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Converter Functions
        function setInputMode(mode) {
            // Hide all input modes
            document.querySelectorAll('.input-mode').forEach(m => m.classList.add('hidden'));
            
            // Show selected mode
            document.getElementById(mode + 'InputMode').classList.remove('hidden');
            
            // Update buttons
            document.querySelectorAll('.input-mode-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            event.target.classList.remove('bg-gray-200', 'text-gray-700');
            event.target.classList.add('bg-primary', 'text-white');
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('inputText').value = e.target.result;
                };
                reader.readAsText(file);
            }
        }

        function toggleVoiceRecording() {
            if (!isRecording) {
                startVoiceRecording();
            } else {
                stopVoiceRecording();
            }
        }

        function startVoiceRecording() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'en-US';
                
                recognition.onstart = function() {
                    isRecording = true;
                    document.getElementById('recordingStatus').classList.remove('hidden');
                    document.querySelector('#voiceInputMode .bg-primary').classList.add('bg-red-600', 'animate-pulse');
                };
                
                recognition.onresult = function(event) {
                    let transcript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        transcript += event.results[i][0].transcript;
                    }
                    document.getElementById('inputText').value = transcript;
                };
                
                recognition.start();
            } else {
                alert('Speech recognition is not supported in your browser');
            }
        }

        function stopVoiceRecording() {
            if (recognition) {
                recognition.stop();
                isRecording = false;
                document.getElementById('recordingStatus').classList.add('hidden');
                document.querySelector('#voiceInputMode .bg-red-600').classList.remove('bg-red-600', 'animate-pulse');
            }
        }

        function convertText() {
            const inputText = document.getElementById('inputText').value;
            if (!inputText.trim()) {
                alert('Please enter some text to convert');
                return;
            }
            
            const bionicText = convertToBionic(inputText);
            document.getElementById('bionicOutput').innerHTML = bionicText;
        }

        function convertToBionic(text) {
            return text.replace(/\b\w+\b/g, function(word) {
                const length = word.length;
                const boldLength = Math.ceil(length * 0.4);

                const boldPart = word.substring(0, boldLength);
                const normalPart = word.substring(boldLength);

                return `<span class="bionic-bold">${boldPart}</span>${normalPart}`;
            });
        }

        function updateFontSize() {
            const fontSize = document.getElementById('fontSize').value;
            document.getElementById('bionicOutput').style.fontSize = fontSize + 'px';
        }

        function updateFontFamily() {
            const fontFamily = document.getElementById('fontFamily').value;
            document.getElementById('bionicOutput').style.fontFamily = fontFamily;
        }

        function exportToPDF() {
            const content = document.getElementById('bionicOutput').textContent;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bionic-text.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function exportToTXT() {
            const content = document.getElementById('bionicOutput').textContent;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'bionic-text.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function speakText() {
            const text = document.getElementById('bionicOutput').textContent;
            const language = document.getElementById('voiceLanguage').value;
            const speed = parseFloat(document.getElementById('voiceSpeed').value);
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = language;
                utterance.rate = speed;
                speechSynthesis.speak(utterance);
            } else {
                alert('Text-to-speech is not supported in your browser');
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const text = document.getElementById('notificationText');
            const container = notification.querySelector('div');
            
            text.textContent = message;
            
            // Reset classes
            container.className = 'bg-white border-l-4 rounded-lg shadow-lg p-4 max-w-sm';
            icon.className = 'w-5 h-5';
            
            // Set type-specific styling
            switch (type) {
                case 'success':
                    container.classList.add('border-green-500');
                    icon.classList.add('text-green-500');
                    icon.innerHTML = '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>';
                    break;
                case 'error':
                    container.classList.add('border-red-500');
                    icon.classList.add('text-red-500');
                    icon.innerHTML = '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>';
                    break;
                default:
                    container.classList.add('border-blue-500');
                    icon.classList.add('text-blue-500');
                    icon.innerHTML = '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>';
            }
            
            notification.classList.remove('hidden');
            setTimeout(() => hideNotification(), 5000);
        }
        
        function hideNotification() {
            document.getElementById('notification').classList.add('hidden');
        }

        // GÃ¶rev tamamlandÄ± bildirimi
        function showAchievementNotification(achievementTitle) {
            showNotification(`ðŸŽ‰ Tebrikler! "${achievementTitle}" gÃ¶revini tamamladÄ±n!`, 'success');
        }

        // Global gÃ¶rev state yÃ¶netimi
        function initializeAchievementStates() {
            if (!localStorage.getItem('achievementStates')) {
                const initialState = {
                    firstLogin: false,
                    profileComplete: false,
                    settingsChanged: false,
                    firstConverter: false,
                    pdfConverted: false,
                    voiceInput: false,
                    firstAIQuestion: false,
                    customText: false,
                    pdfDownload: false,
                    library1Text: false,
                    library5Texts: false,
                    differentLanguage: false,
                    inviteFriend: false
                };
                localStorage.setItem('achievementStates', JSON.stringify(initialState));
            }
        }

        // GÃ¶rev durumunu gÃ¼ncelle
        function updateAchievementState(key, value) {
            const states = JSON.parse(localStorage.getItem('achievementStates') || '{}');
            states[key] = value;
            localStorage.setItem('achievementStates', JSON.stringify(states));
            updateAchievements(); // GÃ¶revleri yeniden kontrol et
        }

        // GÃ¶rev durumunu al
        function getAchievementState(key) {
            const states = JSON.parse(localStorage.getItem('achievementStates') || '{}');
            return states[key] || false;
        }

        // Load user statistics from Firebase
        async function loadUserStats() {
            if (!window.firebaseAuth.currentUser) {
                console.log('No user logged in, skipping stats load');
                return;
            }
            
            try {
                console.log('Loading user stats for:', window.firebaseAuth.currentUser.uid);
                
                // Use simple query without orderBy to avoid index requirements
                const q = window.firebaseServices.query(
                    window.firebaseServices.collection(window.firebaseDb, 'testResults'),
                    window.firebaseServices.where('userId', '==', window.firebaseAuth.currentUser.uid)
                );
                
                const querySnapshot = await window.firebaseServices.getDocs(q);
                const results = [];
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    results.push({ id: doc.id, ...data });
                });
                
                // Sort results by date on the client side
                results.sort((a, b) => {
                    const dateA = new Date(a.testDate || a.createdAt || new Date());
                    const dateB = new Date(b.testDate || b.createdAt || new Date());
                    return dateB - dateA;
                });
                
                console.log('Successfully loaded', results.length, 'test results');
                
                // Update global userTestData for AI assistant
                userTestData = results;
                
                updateProfileUI(results);
                updateRecentTests(results);
                updateAchievements(results);
                drawProgressChart(results);
                
                if (results.length > 0) {
                    showNotification(`Loaded ${results.length} test results successfully!`, 'success');
                } else {
                    showNotification('No test results found. Take your first test!', 'info');
                }
                
            } catch (error) {
                console.error('Error loading user stats:', error);
                
                // Still update UI with empty results to show user info
                updateProfileUI([]);
                updateRecentTests([]);
                updateAchievements([]);
                drawProgressChart([]);
                
                // Show specific error messages
                if (error.code === 'failed-precondition') {
                    showNotification('Database is still setting up. Your data is safe - please try refreshing in a moment.', 'info');
                } else if (error.code === 'permission-denied') {
                    showNotification('Permission denied. Please sign out and sign back in.', 'error');
                } else {
                    showNotification('Temporary connection issue. Your profile is still available.', 'info');
                }
            }
        }

        async function loadLeaderboard() {
            try {
                const tbody = document.getElementById('leaderboardBody');
                if (!tbody) return;
                tbody.innerHTML = '';

                // TÃ¼m testResults koleksiyonunu Ã§ek
                const q = window.firebaseServices.query(
                    window.firebaseServices.collection(window.firebaseDb, 'testResults')
                );
                const snapshot = await window.firebaseServices.getDocs(q);

                // KullanÄ±cÄ± bazÄ±nda grupla
                const byUser = new Map();
                snapshot.forEach(doc => {
                    const d = doc.data();
                    if (!d.userId || typeof d.bionicWPM !== 'number') return;
                    if (!byUser.has(d.userId)) {
                        byUser.set(d.userId, { userId: d.userId, userEmail: d.userEmail || '', tests: 0, sumBionic: 0 });
                    }
                    const u = byUser.get(d.userId);
                    u.tests += 1;
                    u.sumBionic += d.bionicWPM;
                });

                // Ortalama bionic WPM hesapla ve sÄ±rala
                const rows = Array.from(byUser.values()).map(u => ({
                    userId: u.userId,
                    userEmail: u.userEmail,
                    tests: u.tests,
                    avgBionic: Math.round(u.sumBionic / Math.max(1, u.tests))
                }))
                .sort((a, b) => b.avgBionic - a.avgBionic)
                .slice(0, 100);

                // Render et
                if (rows.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">No data yet</td></tr>`;
                    return;
                }

                rows.forEach((r, idx) => {
                    const safeName = (r.userEmail ? r.userEmail.split('@')[0] : r.userId).slice(0, 20);
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${idx + 1}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${safeName}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 font-semibold">${r.avgBionic}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${r.tests}</td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (e) {
                console.error('Error loading leaderboard', e);
                const tbody = document.getElementById('leaderboardBody');
                if (tbody) tbody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-red-500">Failed to load leaderboard</td></tr>`;
            }
        }

        function updateProfileUI(results) {
            const user = window.firebaseAuth.currentUser;
            if (!user) {
                console.log('No user found for profile update');
                return;
            }
            
            console.log('Updating profile UI for user:', user.email);
            
            // Update profile header
            const userName = user.displayName || user.email.split('@')[0] || 'BionicText User';
            document.getElementById('profileUserName').textContent = userName;
            document.getElementById('profileUserEmail').textContent = user.email;
            document.getElementById('userInitials').textContent = userName.charAt(0).toUpperCase();
            
            // Format member since date
            const memberDate = user.metadata.creationTime ? 
                new Date(user.metadata.creationTime).toLocaleDateString() : 
                new Date().toLocaleDateString();
            document.getElementById('memberSince').textContent = memberDate;
            document.getElementById('totalTests').textContent = results.length;
            
            if (results.length > 0) {
                const testsCompleted = results.length;
                const avgNormal = Math.round(results.reduce((sum, r) => sum + r.normalWPM, 0) / testsCompleted);
                const avgBionic = Math.round(results.reduce((sum, r) => sum + r.bionicWPM, 0) / testsCompleted);
                const avgImprovement = results.reduce((sum, r) => sum + r.improvement, 0) / testsCompleted;
                const bestImprovement = Math.max(...results.map(r => r.improvement));
                
                document.getElementById('avgNormalSpeed').textContent = avgNormal;
                document.getElementById('avgBionicSpeed').textContent = avgBionic;
                document.getElementById('avgImprovement').textContent = (avgImprovement > 0 ? '+' : '') + avgImprovement.toFixed(1) + '%';
                document.getElementById('bestImprovement').textContent = (bestImprovement > 0 ? '+' : '') + bestImprovement.toFixed(1) + '%';
            } else {
                // Reset to default values
                document.getElementById('avgNormalSpeed').textContent = '0';
                document.getElementById('avgBionicSpeed').textContent = '0';
                document.getElementById('avgImprovement').textContent = '0%';
                document.getElementById('bestImprovement').textContent = '0%';
            }
        }

        function updateRecentTests(results) {
            const container = document.getElementById('recentTests');
            
            if (results.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <p>No test results yet. Take your first reading speed test!</p>
                        <button onclick="showSection('test')" class="mt-2 text-primary hover:text-blue-800 font-medium">Start Test</button>
                    </div>
                `;
                return;
            }
            
            const recentResults = results.slice(0, 5);
            container.innerHTML = recentResults.map(result => {
                const date = new Date(result.testDate).toLocaleDateString();
                const improvementClass = result.improvement >= 0 ? 'text-green-600' : 'text-red-600';
                const improvementText = (result.improvement > 0 ? '+' : '') + result.improvement.toFixed(1) + '%';
                
                return `
                    <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                        <div class="flex-1">
                            <div class="flex justify-between items-center">
                                <span class="font-medium text-gray-900">${date}</span>
                                <span class="font-bold ${improvementClass}">${improvementText}</span>
                            </div>
                            <div class="text-sm text-gray-500">
                                Normal: ${result.normalWPM} WPM â€¢ BionicText: ${result.bionicWPM} WPM
                            </div>
                        </div>
                        <button onclick="downloadTestResult('${result.id}')" class="ml-3 text-primary hover:text-blue-800 text-sm">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </button>
                    </div>
                `;
            }).join('');
        }

        function updateAchievementsPagination() {
            const pageInfo = document.getElementById('achievementPageInfo');
            const prevBtn = document.getElementById('prevAchievements');
            const nextBtn = document.getElementById('nextAchievements');
            
            if (pageInfo) {
                pageInfo.textContent = `Sayfa ${currentAchievementPage}`;
            }
            
            if (prevBtn) {
                prevBtn.disabled = currentAchievementPage === 1;
                prevBtn.classList.toggle('opacity-50', currentAchievementPage === 1);
                prevBtn.classList.toggle('cursor-not-allowed', currentAchievementPage === 1);
            }
            
            if (nextBtn) {
                // Toplam sayfa sayÄ±sÄ±nÄ± hesapla (26 gÃ¶rev, sayfa baÅŸÄ± 4 gÃ¶rev)
                const totalPages = Math.ceil(26 / achievementsPerPage);
                nextBtn.disabled = currentAchievementPage >= totalPages;
                nextBtn.classList.toggle('opacity-50', currentAchievementPage >= totalPages);
                nextBtn.classList.toggle('cursor-not-allowed', currentAchievementPage >= totalPages);
            }
        }

        function updateAchievements(results) {
            updateAchievementsFromStates();
            const achievements = [
                {
                    id: 'first-test',
                    title: 'First Test',
                    description: 'Complete your first reading test',
                    icon: 'ðŸ†',
                    condition: results.length >= 1
                },
                {
                    id: 'speed-demon',
                    title: 'Speed Demon',
                    description: 'Reach 300+ WPM with BionicText',
                    icon: 'âš¡',
                    condition: results.some(r => r.bionicWPM >= 300)
                },
                {
                    id: 'consistent-reader',
                    title: 'Consistent Reader',
                    description: 'Complete 10 tests',
                    icon: 'ðŸ“ˆ',
                    condition: results.length >= 10
                },
                {
                    id: 'improvement-master',
                    title: 'Improvement Master',
                    description: 'Achieve 50%+ improvement',
                    icon: 'ðŸŽ¯',
                    condition: results.some(r => r.improvement >= 50)
                },
                // Yeni gÃ¶revler
                {
                    id: 'first-login',
                    title: 'Ä°lk GiriÅŸ',
                    description: 'Ä°lk kez giriÅŸ yap',
                    icon: 'ðŸ”‘',
                    condition: false // GeÃ§ici olarak false, daha sonra implemente edilecek
                },
                {
                    id: 'profile-complete',
                    title: 'Profil TamamlandÄ±',
                    description: 'Profilini doldur',
                    icon: 'ðŸ‘¤',
                    condition: false
                },
                {
                    id: 'settings-changed',
                    title: 'Okuma AyarlarÄ±',
                    description: 'Okuma ayarlarÄ±nÄ± deÄŸiÅŸtir',
                    icon: 'âš™ï¸',
                    condition: false
                },
                {
                    id: 'first-converter',
                    title: 'Ä°lk DÃ¶nÃ¼ÅŸÃ¼m',
                    description: 'Ä°lk kez BionicText dÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ kullan',
                    icon: 'ðŸ”„',
                    condition: false
                },
                {
                    id: 'pdf-converted',
                    title: 'PDF DÃ¶nÃ¼ÅŸÃ¼mÃ¼',
                    description: 'Bir PDF dÃ¶nÃ¼ÅŸtÃ¼r',
                    icon: 'ðŸ“„',
                    condition: false
                },
                {
                    id: 'voice-input',
                    title: 'Sesli GiriÅŸ',
                    description: 'Sesli giriÅŸ ile metin dÃ¶nÃ¼ÅŸtÃ¼r',
                    icon: 'ðŸŽ¤',
                    condition: false
                },
                {
                    id: 'first-ai-question',
                    title: 'AI Asistan',
                    description: 'Ä°lk kez AI Assistant\'a soru sor',
                    icon: 'ðŸ¤–',
                    condition: false
                },
                {
                    id: '10min-reading',
                    title: '10 Dakika Okuma',
                    description: '10 dakika boyunca kesintisiz okuma yap',
                    icon: 'â±ï¸',
                    condition: false
                },
                {
                    id: '1000-words',
                    title: '1000 Kelime',
                    description: '1000 kelime oku',
                    icon: 'ðŸ“–',
                    condition: false
                },
                {
                    id: '5000-words',
                    title: '5000 Kelime',
                    description: '5000 kelime oku',
                    icon: 'ðŸ“š',
                    condition: false
                },
                {
                    id: '10000-words',
                    title: '10.000 Kelime',
                    description: '10.000 kelime oku',
                    icon: 'ðŸ›ï¸',
                    condition: false
                },
                {
                    id: 'speed-improvement-20',
                    title: 'HÄ±z ArtÄ±ÅŸÄ±',
                    description: 'Okuma hÄ±zÄ±nÄ± %20 artÄ±r',
                    icon: 'ðŸš€',
                    condition: false
                },
                {
                    id: '3-days-streak',
                    title: '3 GÃ¼n Ãœst Ãœste',
                    description: 'Arka arkaya 3 gÃ¼n giriÅŸ yap',
                    icon: 'ðŸ”¥',
                    condition: false
                },
                {
                    id: '7-days-streak',
                    title: '7 GÃ¼n Ãœst Ãœste',
                    description: '7 gÃ¼n Ã¼st Ã¼ste giriÅŸ yap',
                    icon: 'ðŸŒŸ',
                    condition: false
                },
                {
                    id: 'custom-text',
                    title: 'Ã–zel Metin',
                    description: 'Kendi metnini testte kullan',
                    icon: 'ðŸ“',
                    condition: false
                },
                {
                    id: 'pdf-download',
                    title: 'PDF Ä°ndirme',
                    description: 'Okuma sonuÃ§larÄ±nÄ± PDF olarak indir',
                    icon: 'ðŸ“¥',
                    condition: false
                },
                {
                    id: 'library-1-text',
                    title: 'KÃ¼tÃ¼phaneci',
                    description: 'KÃ¼tÃ¼phaneye 1 metin ekle',
                    icon: 'ðŸ“‹',
                    condition: false
                },
                {
                    id: 'library-5-texts',
                    title: 'KÃ¼tÃ¼phane UstasÄ±',
                    description: 'KÃ¼tÃ¼phaneye 5 metin ekle',
                    icon: 'ðŸ“š',
                    condition: false
                },
                {
                    id: 'different-language',
                    title: 'Ã‡ok Dilli',
                    description: 'BaÅŸka bir dil seÃ§ ve dene',
                    icon: 'ðŸŒŽ',
                    condition: false
                },
                {
                    id: 'invite-friend',
                    title: 'ArkadaÅŸ Daveti',
                    description: 'ArkadaÅŸÄ±nÄ± davet et',
                    icon: 'ðŸ‘¥',
                    condition: false
                },
                {
                    id: 'first-3-tasks',
                    title: 'Ä°lk 3 GÃ¶rev',
                    description: 'Ä°lk 3 task\'Ä± bitir',
                    icon: 'ðŸ¥‰',
                    condition: false
                },
                {
                    id: '10-tasks',
                    title: '10 GÃ¶rev',
                    description: '10 task\'Ä± bitir',
                    icon: 'ðŸ”Ÿ',
                    condition: false
                },
                {
                    id: 'half-tasks',
                    title: 'YarÄ± Yol',
                    description: 'TÃ¼m task\'larÄ±n %50\'sini bitir',
                    icon: 'ðŸŽ¯',
                    condition: false
                },
                {
                    id: 'all-tasks',
                    title: 'Tamamlanan TÃ¼m GÃ¶revler',
                    description: 'TÃ¼m task\'larÄ±n hepsini bitir',
                    icon: 'ðŸ…',
                    condition: false
                }
            ];
            
            const container = document.getElementById('achievements');
            
            // Sayfalama iÃ§in gÃ¶revleri filtrele
            const startIndex = (currentAchievementPage - 1) * achievementsPerPage;
            const endIndex = startIndex + achievementsPerPage;
            const paginatedAchievements = achievements.slice(startIndex, endIndex);
            
            container.innerHTML = paginatedAchievements.map(achievement => {
                const isUnlocked = achievement.condition;
                const bgClass = isUnlocked ? 'bg-green-50' : 'bg-gray-50';
                const textClass = isUnlocked ? 'text-green-700' : 'text-gray-700';
                const iconBg = isUnlocked ? 'bg-green-500' : 'bg-gray-300';
                const opacity = isUnlocked ? '' : 'opacity-50';
                
                return `
                    <div class="flex items-center p-3 ${bgClass} rounded-lg ${opacity}">
                        <div class="w-8 h-8 ${iconBg} rounded-full flex items-center justify-center mr-3">
                            <span class="text-sm">${achievement.icon}</span>
                        </div>
                        <div>
                            <div class="font-medium ${textClass}">${achievement.title}</div>
                            <div class="text-xs text-gray-500">${achievement.description}</div>
                        </div>
                        ${isUnlocked ? '<div class="ml-auto text-green-500"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div>' : ''}
                    </div>
                `;
            }).join('');
        }

        function drawProgressChart(results) {
            const canvas = document.getElementById('progressChart');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (results.length === 0) {
                ctx.fillStyle = '#9CA3AF';
                ctx.font = '16px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('No data to display', canvas.width / 2, canvas.height / 2);
                return;
            }
            
            const recentResults = results.slice(0, 10).reverse();
            const maxWPM = Math.max(...recentResults.flatMap(r => [r.normalWPM, r.bionicWPM]));
            const padding = 40;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            
            // Draw axes
            ctx.strokeStyle = '#E5E7EB';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();
            
            // Draw data points
            const pointSpacing = chartWidth / Math.max(recentResults.length - 1, 1);
            
            // Normal text line
            ctx.strokeStyle = '#1A2B4C';
            ctx.lineWidth = 2;
            ctx.beginPath();
            recentResults.forEach((result, index) => {
                const x = padding + index * pointSpacing;
                const y = canvas.height - padding - (result.normalWPM / maxWPM) * chartHeight;
                if (index === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();
            
            // BionicText line
            ctx.strokeStyle = '#10B981';
            ctx.lineWidth = 2;
            ctx.beginPath();
            recentResults.forEach((result, index) => {
                const x = padding + index * pointSpacing;
                const y = canvas.height - padding - (result.bionicWPM / maxWPM) * chartHeight;
                if (index === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();
            
            // Legend
            ctx.fillStyle = '#1A2B4C';
            ctx.font = '12px Inter';
            ctx.fillText('Normal Text', padding, 20);
            ctx.fillStyle = '#10B981';
            ctx.fillText('BionicText', padding + 80, 20);
        }

        async function exportAllData() {
            if (!window.firebaseAuth.currentUser) {
                showNotification('Please sign in to export data', 'error');
                return;
            }
            
            try {
                // Use simple query without orderBy
                const q = window.firebaseServices.query(
                    window.firebaseServices.collection(window.firebaseDb, 'testResults'),
                    window.firebaseServices.where('userId', '==', window.firebaseAuth.currentUser.uid)
                );
                
                const querySnapshot = await window.firebaseServices.getDocs(q);
                const results = [];
                querySnapshot.forEach((doc) => {
                    results.push(doc.data());
                });
                
                // Sort by date on client side
                results.sort((a, b) => {
                    const dateA = new Date(a.testDate || a.createdAt || new Date());
                    const dateB = new Date(b.testDate || b.createdAt || new Date());
                    return dateB - dateA;
                });
                
                if (results.length === 0) {
                    showNotification('No test data to export. Take some tests first!', 'info');
                    return;
                }
                
                const csvContent = [
                    'Date,Normal WPM,BionicText WPM,Improvement %',
                    ...results.map(r => `${new Date(r.testDate || r.createdAt).toLocaleDateString()},${r.normalWPM},${r.bionicWPM},${r.improvement.toFixed(1)}`)
                ].join('\n');
                
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'bionictext-reading-data.csv';
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification(`Successfully exported ${results.length} test results!`, 'success');
            } catch (error) {
                console.error('Error exporting data:', error);
                showNotification('Export failed. Please try again in a moment.', 'error');
            }
        }

        async function deleteAllData() {
            if (!window.firebaseAuth.currentUser) {
                showNotification('Please sign in to delete data', 'error');
                return;
            }
            
            if (!confirm('Are you sure you want to delete all your test data? This action cannot be undone.')) {
                return;
            }
            
            try {
                const q = window.firebaseServices.query(
                    window.firebaseServices.collection(window.firebaseDb, 'testResults'),
                    window.firebaseServices.where('userId', '==', window.firebaseAuth.currentUser.uid)
                );
                
                const querySnapshot = await window.firebaseServices.getDocs(q);
                const deletePromises = [];
                querySnapshot.forEach((doc) => {
                    deletePromises.push(window.firebaseServices.deleteDoc(doc.ref));
                });
                
                await Promise.all(deletePromises);
                await loadUserStats(); // Refresh the UI
                showNotification('All data deleted successfully', 'success');
            } catch (error) {
                console.error('Error deleting data:', error);
                showNotification('Failed to delete data', 'error');
            }
        }

        function downloadTestResult(resultId) {
            // This would download a specific test result
            showNotification('Individual test download feature coming soon!', 'info');
        }

        // Profile menu functions
        function toggleProfileMenu() {
            const dropdown = document.getElementById('profileDropdown');
            dropdown.classList.toggle('hidden');
        }

        function closeProfileMenu() {
            document.getElementById('profileDropdown').classList.add('hidden');
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            if (!menu) return;
            menu.classList.toggle('hidden');
        }
        function closeMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            if (!menu) return;
            menu.classList.add('hidden');
        }

        // Close profile menu when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            const dropdown = document.getElementById('profileDropdown');
            
            if (userMenu && !userMenu.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });

        // Handle authentication state changes
        function handleAuthStateChange(user) {
            console.log('Auth state changed:', user ? 'User logged in' : 'User logged out');
            
            if (user) {
                // User is signed in
                console.log('Setting up UI for logged in user:', user.email);
                document.getElementById('authButtons').classList.add('hidden');
                document.getElementById('userMenu').classList.remove('hidden');
                
                // Update profile info in navigation and dropdown
                const userName = user.displayName || user.email.split('@')[0] || 'User';
                const userInitials = userName.charAt(0).toUpperCase();
                
                document.getElementById('userNameNav').textContent = userName;
                document.getElementById('userInitialsNav').textContent = userInitials;
                document.getElementById('userNameDropdown').textContent = userName;
                document.getElementById('userInitialsDropdown').textContent = userInitials;
                document.getElementById('userEmailDropdown').textContent = user.email;
                
                // Always update profile UI with user info immediately
                updateProfileUI([]);
                
                // Load user stats and update profile
                loadUserStats();
                
                // Show success notification only on fresh login (not on page refresh)
                if (!window.initialAuthCheck) {
                    showNotification(`Welcome back, ${user.email}!`, 'success');
                }
                window.initialAuthCheck = true;
                
            } else {
                // User is signed out
                console.log('Setting up UI for logged out state');
                document.getElementById('authButtons').classList.remove('hidden');
                document.getElementById('userMenu').classList.add('hidden');
                
                // Reset profile UI to default values
                document.getElementById('profileUserName').textContent = 'User Profile';
                document.getElementById('profileUserEmail').textContent = 'user@example.com';
                document.getElementById('userInitials').textContent = 'U';
                document.getElementById('memberSince').textContent = 'Today';
                document.getElementById('totalTests').textContent = '0';
                document.getElementById('avgNormalSpeed').textContent = '0';
                document.getElementById('avgBionicSpeed').textContent = '0';
                document.getElementById('avgImprovement').textContent = '0%';
                document.getElementById('bestImprovement').textContent = '0%';
                
                // Reset recent tests
                document.getElementById('recentTests').innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <p>Please sign in to view your test history</p>
                    </div>
                `;
                
                // Reset achievements
                updateAchievements([]);
                
                // Clear chart
                const canvas = document.getElementById('progressChart');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#9CA3AF';
                ctx.font = '16px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('Sign in to view progress', canvas.width / 2, canvas.height / 2);
                
                window.initialAuthCheck = true;
            }
        }

        // AI Assistant Functions
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendQuickMessage(message) {
            document.getElementById('chatInput').value = message;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addMessageToChat(message, 'user');
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Get AI response
            const response = await getAIResponse(message);
            
            // Remove typing indicator and add AI response
            hideTypingIndicator();
            addMessageToChat(response, 'ai');
            
            // Save to chat history
            chatHistory.push({ user: message, ai: response, timestamp: new Date() });
        }

        function addMessageToChat(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex items-start space-x-3';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </div>
                    <div class="bg-primary text-white rounded-lg p-3 shadow-sm max-w-md ml-auto">
                        <p>${message}</p>
                    </div>
                `;
                messageDiv.classList.add('flex-row-reverse');
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <div class="bg-white rounded-lg p-3 shadow-sm max-w-md">
                        <p class="text-gray-800">${message}</p>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'flex items-start space-x-3';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </div>
                <div class="bg-white rounded-lg p-3 shadow-sm">
                    <div class="flex space-x-1">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        async function getAIResponse(userMessage) {
            // Simulate AI thinking time
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
            
            const message = userMessage.toLowerCase();
            
            // Check for user data requests (Turkish and English keywords)
            if (message.includes('statistics') || message.includes('stats') || message.includes('data') || message.includes('performance') || 
                message.includes('istatistik') || message.includes('veri') || message.includes('performans') || message.includes('sonuÃ§')) {
                return generateStatsResponse();
            }
            
            // BionicText explanations (Turkish and English keywords)
            if (message.includes('bionic') || message.includes('what is') || message.includes('nedir') || message.includes('nasÄ±l') || message.includes('ne')) {
                return getBionicTextExplanation();
            }
            
            // Reading speed tips (Turkish and English keywords)
            if (message.includes('improve') || message.includes('faster') || message.includes('speed') || message.includes('tips') ||
                message.includes('geliÅŸtir') || message.includes('hÄ±zlÄ±') || message.includes('artÄ±r') || message.includes('ipuÃ§')) {
                return getReadingTips();
            }
            
            // Benefits of speed reading (Turkish and English keywords)
            if (message.includes('benefit') || message.includes('advantage') || message.includes('why') ||
                message.includes('fayda') || message.includes('avantaj') || message.includes('neden') || message.includes('yarar')) {
                return getSpeedReadingBenefits();
            }
            
            // General conversation
            return getGeneralResponse(userMessage);
        }

        function generateStatsResponse() {
            const user = window.firebaseAuth?.currentUser;
            
            if (!user) {
                if (currentLanguage === 'tr') {
                    return "Okuma istatistiklerinizi analiz etmek isterim, ancak Ã¶nce giriÅŸ yapmanÄ±z gerekiyor! GiriÅŸ yaptÄ±ktan ve bazÄ± testler aldÄ±ktan sonra, okuma performansÄ±nÄ±z, geliÅŸim trendleriniz ve kiÅŸiselleÅŸtirilmiÅŸ Ã¶neriler hakkÄ±nda detaylÄ± bilgiler verebilirim.";
                }
                return "I'd love to analyze your reading statistics, but you'll need to sign in first! Once you're logged in and have taken some tests, I can provide detailed insights about your reading performance, improvement trends, and personalized recommendations.";
            }
            
            if (userTestData.length === 0) {
                if (currentLanguage === 'tr') {
                    return "Profilinizde henÃ¼z test sonucu gÃ¶remiyorum. BaÅŸlamak iÃ§in ilk okuma hÄ±zÄ± testinizi yapÄ±n! Biraz veriniz olduÄŸunda, performansÄ±nÄ±zÄ± analiz edebilir, ilerlemenizi takip edebilir ve okuma hÄ±zÄ±nÄ±zÄ± artÄ±rmak iÃ§in kiÅŸiselleÅŸtirilmiÅŸ ipuÃ§larÄ± verebilirim.";
                }
                return "I don't see any test results in your profile yet. Take your first reading speed test to get started! Once you have some data, I can analyze your performance, track your progress, and give you personalized tips to improve your reading speed.";
            }
            
            const totalTests = userTestData.length;
            const avgNormal = Math.round(userTestData.reduce((sum, test) => sum + test.normalWPM, 0) / totalTests);
            const avgBionic = Math.round(userTestData.reduce((sum, test) => sum + test.bionicWPM, 0) / totalTests);
            const avgImprovement = (userTestData.reduce((sum, test) => sum + test.improvement, 0) / totalTests).toFixed(1);
            const bestImprovement = Math.max(...userTestData.map(test => test.improvement)).toFixed(1);
            const latestTest = userTestData[0];
            
            if (currentLanguage === 'tr') {
                return `Ä°ÅŸte okuma performans analiziniz:

ðŸ“Š **Genel Ä°statistikler:**
â€¢ Tamamlanan toplam test: ${totalTests}
â€¢ Ortalama normal okuma hÄ±zÄ±: ${avgNormal} DKK
â€¢ Ortalama BionicText hÄ±zÄ±: ${avgBionic} DKK
â€¢ Ortalama geliÅŸim: ${avgImprovement > 0 ? '+' : ''}${avgImprovement}%
â€¢ En iyi geliÅŸim: +${bestImprovement}%

ðŸ“ˆ **Son Test SonuÃ§larÄ±:**
â€¢ Normal metin: ${latestTest.normalWPM} DKK
â€¢ BionicText: ${latestTest.bionicWPM} DKK
â€¢ GeliÅŸim: ${latestTest.improvement > 0 ? '+' : ''}${latestTest.improvement.toFixed(1)}%

ðŸ’¡ **DeÄŸerlendirme:**
${avgImprovement > 20 ? "MÃ¼kemmel! BionicText'ten harika faydalar gÃ¶rÃ¼yorsunuz. Bu geliÅŸimi sÃ¼rdÃ¼rmek iÃ§in pratik yapmaya devam edin." : avgImprovement > 0 ? "Ä°yi ilerleme! GeliÅŸim oranÄ±nÄ±zÄ± artÄ±rÄ±p artÄ±ramayacaÄŸÄ±nÄ±zÄ± gÃ¶rmek iÃ§in daha fazla test yapmayÄ± deneyin." : "HenÃ¼z geliÅŸim gÃ¶rmÃ¼yorsanÄ±z endiÅŸelenmeyin. HÄ±zlÄ± okuma pratik gerektirir - BionicText'in kalÄ±n kÄ±sÄ±mlarÄ±na daha fazla odaklanmayÄ± deneyin."}

Okuma hÄ±zÄ±nÄ±zÄ± daha da artÄ±rmak iÃ§in Ã¶zel ipuÃ§larÄ± ister misiniz?`;
            }
            
            return `Here's your reading performance analysis:

ðŸ“Š **Overall Statistics:**
â€¢ Total tests completed: ${totalTests}
â€¢ Average normal reading speed: ${avgNormal} WPM
â€¢ Average BionicText speed: ${avgBionic} WPM
â€¢ Average improvement: ${avgImprovement > 0 ? '+' : ''}${avgImprovement}%
â€¢ Best improvement achieved: +${bestImprovement}%

ðŸ“ˆ **Latest Test Results:**
â€¢ Normal text: ${latestTest.normalWPM} WPM
â€¢ BionicText: ${latestTest.bionicWPM} WPM
â€¢ Improvement: ${latestTest.improvement > 0 ? '+' : ''}${latestTest.improvement.toFixed(1)}%

ðŸ’¡ **Insights:**
${avgImprovement > 20 ? "Excellent! You're seeing great benefits from BionicText. Keep practicing to maintain this improvement." : avgImprovement > 0 ? "Good progress! Try taking more tests to see if you can increase your improvement rate." : "Don't worry if you're not seeing improvements yet. Speed reading takes practice - try focusing on the bold parts of BionicText more."}

Would you like specific tips to improve your reading speed further?`;
        }

        function getBionicTextExplanation() {
            if (currentLanguage === 'tr') {
                return `BionicText, okuma hÄ±zÄ±nÄ±zÄ± ve anlayÄ±ÅŸÄ±nÄ±zÄ± artÄ±ran devrimci bir okuma formatÄ±dÄ±r! Ä°ÅŸte nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±:

ðŸ”¤ **Bilim:**
BionicText her kelimenin ilk %40'Ä±nÄ± kalÄ±nlaÅŸtÄ±rarak gÃ¶zleriniz iÃ§in "odak noktalarÄ±" oluÅŸturur. Bu, beyninizin metni daha verimli iÅŸlemesine yardÄ±mcÄ± olur:
â€¢ Gereken gÃ¶z hareketlerinin sayÄ±sÄ±nÄ± azaltÄ±r
â€¢ Kelimeleri daha hÄ±zlÄ± tanÄ±manÄ±za yardÄ±mcÄ± olur
â€¢ DoÄŸal okuma akÄ±ÅŸÄ±nÄ± korur

âš¡ **Faydalar:**
â€¢ %200'e kadar daha hÄ±zlÄ± okuma
â€¢ Daha iyi anlayÄ±ÅŸ korunmasÄ±
â€¢ AzaltÄ±lmÄ±ÅŸ gÃ¶z yorgunluÄŸu
â€¢ Her tÃ¼rlÃ¼ metin iÃ§eriÄŸiyle Ã§alÄ±ÅŸÄ±r

ðŸ§  **Beyniniz NasÄ±l Ä°ÅŸler:**
Beyniniz kalÄ±p tanÄ±mada inanÄ±lmaz! Kelimelerin kalÄ±n baÅŸlangÄ±Ã§larÄ±nÄ± gÃ¶rdÃ¼ÄŸÃ¼nÃ¼zde, beyniniz genellikle gÃ¶zleriniz okumayÄ± bitirmeden Ã¶nce kelimenin geri kalanÄ±nÄ± tahmin edebilir ve "tamamlayabilir".

FarkÄ± kendiniz gÃ¶rmek iÃ§in okuma hÄ±zÄ± testimizi deneyin! Ã‡oÄŸu kullanÄ±cÄ± ilk testinde hemen geliÅŸme gÃ¶rÃ¼r.

BionicText okuma deneyiminizi nasÄ±l maksimize edeceÄŸiniz konusunda ipuÃ§larÄ± ister misiniz?`;
            }
            
            return `BionicText is a revolutionary reading format that enhances your reading speed and comprehension! Here's how it works:

ðŸ”¤ **The Science:**
BionicText bolds the first 40% of each word, creating "fixation points" for your eyes. This helps your brain process text more efficiently by:
â€¢ Reducing the number of eye movements needed
â€¢ Helping you recognize words faster
â€¢ Maintaining natural reading flow

âš¡ **Benefits:**
â€¢ Up to 200% faster reading speed
â€¢ Better comprehension retention
â€¢ Reduced eye strain
â€¢ Works with any text content

ðŸ§  **How Your Brain Processes It:**
Your brain is amazing at pattern recognition! When you see the bolded beginning of words, your brain can often predict and "fill in" the rest of the word before your eyes even finish reading it.

Try our reading speed test to see the difference for yourself! Most users see immediate improvements in their first test.

Would you like some tips on how to maximize your BionicText reading experience?`;
        }

        function getReadingTips() {
            if (currentLanguage === 'tr') {
                const tips = [
                    "ðŸŽ¯ **KalÄ±n KÄ±sÄ±mlara OdaklanÄ±n**: BionicText'te kalÄ±n kÄ±sÄ±mlara konsantre olun - beyninizin geri kalanÄ±nÄ± doÄŸal olarak tamamlamasÄ±na izin verin.",
                    "ðŸ‘€ **Ä°Ã§ Sesi AzaltÄ±n**: Okurken kafanÄ±zda kelimeleri 'duymamaya' Ã§alÄ±ÅŸÄ±n. Bu zihinsel ses sizi Ã¶nemli Ã¶lÃ§Ã¼de yavaÅŸlatÄ±r.",
                    "ðŸ“– **Ä°ÅŸaretÃ§i KullanÄ±n**: GÃ¶zlerinizi yÃ¶nlendirmek iÃ§in parmaÄŸÄ±nÄ±zÄ± veya kaleminizi kullanÄ±n. Bu odaklanmayÄ± korur ve geriye dÃ¶nÃ¼ÅŸÃ¼ (tekrar okuma) Ã¶nler.",
                    "â±ï¸ **GÃ¼nlÃ¼k Pratik YapÄ±n**: BionicText ile gÃ¼nde sadece 10-15 dakika pratik bile Ã¶nemli geliÅŸmelere yol aÃ§abilir.",
                    "ðŸ”„ **Geriye DÃ¶nÃ¼ÅŸÃ¼ Minimize Edin**: Beyninizin anlama yeteneÄŸine gÃ¼venin. Kesinlikle gerekli olmadÄ±kÃ§a tekrar okumak iÃ§in geri dÃ¶nmekten kaÃ§Ä±nÄ±n.",
                    "ðŸ“ **GÃ¶rÃ¼ÅŸ AlanÄ±nÄ±zÄ± GeniÅŸletin**: Tek tek kelimeler yerine kelime gruplarÄ±nÄ± gÃ¶rmeye Ã§alÄ±ÅŸÄ±n. Bu okuma aralÄ±ÄŸÄ±nÄ±zÄ± artÄ±rÄ±r.",
                    "ðŸ§˜ **Rahat KalÄ±n**: YÃ¼zÃ¼nÃ¼zdeki ve gÃ¶zlerinizdeki gerginlik sizi yavaÅŸlatabilir. Okurken yÃ¼z kaslarÄ±nÄ±zÄ± gevÅŸek tutun.",
                    "ðŸ“š **TanÄ±dÄ±k Ä°Ã§erikle BaÅŸlayÄ±n**: KarmaÅŸÄ±k materyale geÃ§meden Ã¶nce zaten iyi bildiÄŸiniz konularla hÄ±zlÄ± okuma pratiÄŸi yapÄ±n."
                ];
                
                const selectedTips = tips.sort(() => 0.5 - Math.random()).slice(0, 4);
                
                return `Ä°ÅŸte okuma hÄ±zÄ±nÄ±zÄ± artÄ±rmak iÃ§in kanÄ±tlanmÄ±ÅŸ teknikler:

${selectedTips.join('\n\n')}

ðŸŽ¯ **Profesyonel Ä°pucu**: Anahtar tutarlÄ± pratiktir! Daha kolay metinlerle baÅŸlayÄ±n ve yavaÅŸ yavaÅŸ daha karmaÅŸÄ±k materyallere geÃ§in. BionicText dÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼mÃ¼z herhangi bir iÃ§erikle pratik yapmanÄ±za yardÄ±mcÄ± olabilir.

Bu tekniklerden herhangi birini daha detaylÄ± aÃ§Ä±klamamÄ± ister misiniz?`;
            }
            
            const tips = [
                "ðŸŽ¯ **Focus on the Bold Parts**: In BionicText, concentrate on the bolded portions - let your brain fill in the rest naturally.",
                "ðŸ‘€ **Reduce Subvocalization**: Try to avoid 'hearing' words in your head as you read. This mental voice slows you down significantly.",
                "ðŸ“– **Use a Pointer**: Use your finger or a pen to guide your eyes. This helps maintain focus and prevents regression (re-reading).",
                "â±ï¸ **Practice Daily**: Even 10-15 minutes of daily practice with BionicText can lead to significant improvements.",
                "ðŸ”„ **Minimize Regression**: Trust your brain's ability to understand. Avoid going back to re-read unless absolutely necessary.",
                "ðŸ“ **Expand Your Vision**: Try to see groups of words rather than individual words. This increases your reading span.",
                "ðŸ§˜ **Stay Relaxed**: Tension in your face and eyes can slow you down. Keep your facial muscles relaxed while reading.",
                "ðŸ“š **Start with Familiar Content**: Practice speed reading with topics you already know well before moving to complex material."
            ];
            
            const selectedTips = tips.sort(() => 0.5 - Math.random()).slice(0, 4);
            
            return `Here are some proven techniques to boost your reading speed:

${selectedTips.join('\n\n')}

ðŸŽ¯ **Pro Tip**: The key is consistent practice! Start with easier texts and gradually work your way up to more complex material. Our BionicText converter can help you practice with any content.

Would you like me to explain any of these techniques in more detail?`;
        }

        function getSpeedReadingBenefits() {
            if (currentLanguage === 'tr') {
                return `HÄ±zlÄ± okuma hem kiÅŸisel hem de profesyonel yaÅŸam iÃ§in inanÄ±lmaz faydalar sunar:

ðŸ“š **Ã–ÄŸrenme ve EÄŸitim:**
â€¢ Ders kitaplarÄ± ve araÅŸtÄ±rma makalelerini daha hÄ±zlÄ± iÅŸleyin
â€¢ SÄ±navlar iÃ§in daha verimli Ã§alÄ±ÅŸÄ±n
â€¢ SektÃ¶r yayÄ±nlarÄ±nÄ± takip edin
â€¢ Yeni beceri ve konularÄ± daha hÄ±zlÄ± Ã¶ÄŸrenin

ðŸ’¼ **Profesyonel Avantajlar:**
â€¢ E-postalarÄ± ve raporlarÄ± daha verimli iÅŸleyin
â€¢ SektÃ¶r haberleri ve trendlerini takip edin
â€¢ SÃ¶zleÅŸme ve belgeleri daha hÄ±zlÄ± iÅŸleyin
â€¢ Genel verimliliÄŸi artÄ±rÄ±n

ðŸ§  **BiliÅŸsel Faydalar:**
â€¢ GeliÅŸmiÅŸ odaklanma ve konsantrasyon
â€¢ Daha iyi bilgi tutma
â€¢ GeliÅŸmiÅŸ anlayÄ±ÅŸ becerileri
â€¢ ArtmÄ±ÅŸ zihinsel Ã§eviklik

â° **Zaman YÃ¶netimi:**
â€¢ GÃ¼nÃ¼nÃ¼zde saatler kazanÄ±n
â€¢ Zevk iÃ§in daha fazla kitap okuyun
â€¢ Zaman baskÄ±sÄ± olmadan bilgi sahibi olun
â€¢ Daha iyi iÅŸ-yaÅŸam dengesi

ðŸŽ¯ **KiÅŸisel GeliÅŸim:**
â€¢ Daha fazla bilgi ve fikre eriÅŸim
â€¢ Okuma gÃ¶revlerinde artan gÃ¼ven
â€¢ Daha iyi akademik ve kariyer fÄ±rsatlarÄ±
â€¢ GeliÅŸmiÅŸ eleÅŸtirel dÃ¼ÅŸÃ¼nme becerileri

Ortalama bir kiÅŸi dakikada 200-300 kelime okur, ancak BionicText ve doÄŸru tekniklerle anlayÄ±ÅŸÄ± koruyarak kolayca 400-600 DKK'ya ulaÅŸabilirsiniz!

HÄ±zlÄ± okuma yolculuÄŸunuza baÅŸlamaya hazÄ±r mÄ±sÄ±nÄ±z? Mevcut seviyenizi gÃ¶rmek iÃ§in okuma testimizi deneyin!`;
            }
            
            return `Speed reading offers incredible benefits for both personal and professional life:

ðŸ“š **Learning & Education:**
â€¢ Process textbooks and research papers faster
â€¢ Study more efficiently for exams
â€¢ Stay current with industry publications
â€¢ Learn new skills and topics quicker

ðŸ’¼ **Professional Advantages:**
â€¢ Handle emails and reports more efficiently
â€¢ Stay on top of industry news and trends
â€¢ Process contracts and documents faster
â€¢ Improve overall productivity

ðŸ§  **Cognitive Benefits:**
â€¢ Enhanced focus and concentration
â€¢ Better information retention
â€¢ Improved comprehension skills
â€¢ Increased mental agility

â° **Time Management:**
â€¢ Free up hours in your day
â€¢ Read more books for pleasure
â€¢ Stay informed without time pressure
â€¢ Better work-life balance

ðŸŽ¯ **Personal Growth:**
â€¢ Access to more knowledge and ideas
â€¢ Increased confidence in reading tasks
â€¢ Better academic and career opportunities
â€¢ Enhanced critical thinking skills

The average person reads 200-300 words per minute, but with BionicText and proper techniques, you can easily reach 400-600 WPM while maintaining comprehension!

Ready to start your speed reading journey? Try our reading test to see your current baseline!`;
        }

        function getGeneralResponse(userMessage) {
            if (currentLanguage === 'tr') {
                const responses = [
                    "Bu ilginÃ§ bir soru! Okuma teknikleri ve BionicText konusunda uzmanlaÅŸmÄ±ÅŸ olsam da, genel konularda da yardÄ±mcÄ± olmaktan mutluluk duyarÄ±m. Ã–zellikle ne Ã¶ÄŸrenmek istersiniz?",
                    "YardÄ±m etmek iÃ§in buradayÄ±m! BionicText AI asistanÄ±nÄ±z olarak okuma stratejilerini tartÄ±ÅŸabilir, performans verilerinizi analiz edebilir veya diÄŸer konular hakkÄ±nda sohbet edebilirim. AklÄ±nÄ±zda ne var?",
                    "Harika bir soru! KullanÄ±cÄ±larÄ±n okuma becerilerini geliÅŸtirmelerine ve BionicText'i anlamalarÄ±na yardÄ±mcÄ± olmayÄ± seviyorum. Okuma veya Ã¶ÄŸrenme hakkÄ±nda keÅŸfetmek istediÄŸiniz Ã¶zel bir ÅŸey var mÄ±?",
                    "SorduÄŸunuz iÃ§in teÅŸekkÃ¼rler! Okuma geliÅŸimi ve BionicText konusunda yardÄ±m etmek iÃ§in tasarlandÄ±m, ancak genel sohbetlerden de keyif alÄ±rÄ±m. BugÃ¼n size nasÄ±l yardÄ±mcÄ± olabilirim?",
                    "Bana ulaÅŸtÄ±ÄŸÄ±nÄ±z iÃ§in minnettarÄ±m! Ä°ster hÄ±zlÄ± okuma, BionicText teknikleri veya genel sorular hakkÄ±nda olsun, yardÄ±m etmek iÃ§in buradayÄ±m. Ne tartÄ±ÅŸmak istersiniz?"
                ];
                
                return responses[Math.floor(Math.random() * responses.length)];
            }
            
            const responses = [
                "That's an interesting question! While I specialize in reading techniques and BionicText, I'm happy to help with general topics too. What specifically would you like to know?",
                "I'm here to help! As your BionicText AI assistant, I can discuss reading strategies, analyze your performance data, or chat about other topics. What's on your mind?",
                "Great question! I love helping users improve their reading skills and understanding BionicText. Is there something specific about reading or learning you'd like to explore?",
                "Thanks for asking! I'm designed to help with reading improvement and BionicText, but I enjoy general conversations too. How can I assist you today?",
                "I appreciate you reaching out! Whether it's about speed reading, BionicText techniques, or general questions, I'm here to help. What would you like to discuss?"
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function clearChat() {
            const chatMessages = document.getElementById('chatMessages');
            // Keep only the welcome message
            const welcomeMessage = chatMessages.firstElementChild;
            chatMessages.innerHTML = '';
            chatMessages.appendChild(welcomeMessage);
            chatHistory = [];
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize language system first
            initializeLanguage();
            
            showSection('home');
            
            // Initialize test with default text
            loadPresetText();
            
            // Achievements sayfalama oklarÄ± iÃ§in tÄ±klama olaylarÄ±
            const prevBtn = document.getElementById('prevAchievements');
            const nextBtn = document.getElementById('nextAchievements');

            if (prevBtn) {
    prevBtn.addEventListener('click', function() {
        if (currentAchievementPage > 1) {
            currentAchievementPage--;
            updateAchievementsPagination();
            updateAchievements(userTestData); // âœ… doÄŸru
        }
    });
}

if (nextBtn) {
    nextBtn.addEventListener('click', function() {
        currentAchievementPage++;
        updateAchievementsPagination();
        updateAchievements(userTestData); // âœ… doÄŸru
    });
}

            
            // Wait for Firebase to be fully loaded
            const initAuth = () => {
                if (window.firebaseAuth && window.firebaseServices) {
                    console.log('Firebase initialized, setting up auth listener');
                    window.firebaseServices.onAuthStateChanged(window.firebaseAuth, handleAuthStateChange);
                } else {
                    console.log('Waiting for Firebase...');
                    setTimeout(initAuth, 500);
                }
            };
            
            initAuth();
        });
    </script>

    <script> 
    // GÃ¶rev tetikleme sistemi - Bu kodu mevcut JavaScript'e ekle
function initializeAchievementSystem() {
    if (!localStorage.getItem('achievementStates')) {
        const initialState = {
            firstLogin: false,
            profileComplete: false,
            settingsChanged: false,
            firstConverter: false,
            pdfConverted: false,
            voiceInput: false,
            firstAIQuestion: false,
            customText: false,
            pdfDownload: false,
            library1Text: false,
            library5Texts: false,
            differentLanguage: false,
            inviteFriend: false,
            firstTest: false,
            tenTests: false,
            hundredTests: false,
            speed50: false,
            profileVisits5: false
        };
        localStorage.setItem('achievementStates', JSON.stringify(initialState));
    }
    
    // KullanÄ±cÄ± giriÅŸ yaptÄ±ÄŸÄ±nda ilk giriÅŸ gÃ¶revini tetikle
    if (window.firebaseAuth && window.firebaseAuth.currentUser) {
        checkFirstLogin();
    }
}

// GÃ¶rev durumunu kontrol et ve gÃ¼ncelle
function updateAchievementState(key, value) {
    const states = JSON.parse(localStorage.getItem('achievementStates') || '{}');
    
    // EÄŸer gÃ¶rev zaten tamamlanmÄ±ÅŸsa tekrar tetikleme
    if (states[key] === true && value === true) return;
    
    states[key] = value;
    localStorage.setItem('achievementStates', JSON.stringify(states));
    
    // EÄŸer gÃ¶rev tamamlandÄ±ysa bildirim gÃ¶ster
    if (value === true) {
        triggerAchievementNotification(key);
    }
    
    // BaÅŸarÄ±mlarÄ± gÃ¼ncelle
    updateAchievementsFromStates();
}

// GÃ¶rev tamamlandÄ±ÄŸÄ±nda bildirim gÃ¶ster
function triggerAchievementNotification(achievementKey) {
    const achievementTitles = {
        firstLogin: 'Ä°lk GiriÅŸ',
        firstTest: 'Ä°lk Testini TamamladÄ±n!',
        tenTests: '10 Test!',
        settingsChanged: 'Okuma AyarlarÄ±',
        firstConverter: 'Ä°lk DÃ¶nÃ¼ÅŸÃ¼m',
        firstAIQuestion: 'AI Asistan',
        customText: 'Ã–zel Metin',
        pdfDownload: 'PDF Ä°ndirme'
    };
    
    const title = achievementTitles[achievementKey] || 'Yeni BaÅŸarÄ±!';
    showAchievementNotification(`ðŸŽ‰ ${title} gÃ¶revini tamamladÄ±n!`);
}

// BaÅŸarÄ± bildirimi
function showAchievementNotification(message) {
    showNotification(message, 'success');
    
    // Ã–zel bir bildirim efekti (isteÄŸe baÄŸlÄ±)
    const achievementNotify = document.createElement('div');
    achievementNotify.className = 'fixed top-20 right-4 z-50 bg-gradient-to-r from-green-500 to-blue-500 text-white px-6 py-4 rounded-lg shadow-lg animate-bounce';
    achievementNotify.innerHTML = `
        <div class="flex items-center">
            <span class="text-2xl mr-3">ðŸŽ‰</span>
            <div>
                <div class="font-bold">Tebrikler!</div>
                <div>${message}</div>
            </div>
        </div>
    `;
    document.body.appendChild(achievementNotify);
    
    setTimeout(() => {
        achievementNotify.remove();
    }, 5000);
}

// GÃ¶rev durumlarÄ±ndan baÅŸarÄ±mlarÄ± gÃ¼ncelle
function updateAchievementsFromStates() {
    const states = JSON.parse(localStorage.getItem('achievementStates') || '{}');
    const testResults = window.userTestData || [];
    
    const achievements = [
        {
            id: 'first-login',
            title: 'Ä°lk GiriÅŸ',
            description: 'Ä°lk kez giriÅŸ yap',
            icon: 'ðŸ”‘',
            condition: states.firstLogin || false
        },
        {
            id: 'first-test',
            title: 'Ä°lk Test',
            description: 'Ä°lk okuma testini tamamla',
            icon: 'ðŸ†',
            condition: states.firstTest || testResults.length >= 1
        },
        {
            id: 'ten-tests',
            title: '10 Test',
            description: '10 test tamamla',
            icon: 'ðŸ”¥',
            condition: states.tenTests || testResults.length >= 10
        },
        {
            id: 'settings-changed',
            title: 'Okuma AyarlarÄ±',
            description: 'Okuma ayarlarÄ±nÄ± deÄŸiÅŸtir',
            icon: 'âš™ï¸',
            condition: states.settingsChanged || false
        },
        {
            id: 'first-converter',
            title: 'Ä°lk DÃ¶nÃ¼ÅŸÃ¼m',
            description: 'Ä°lk kez BionicText dÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ kullan',
            icon: 'ðŸ”„',
            condition: states.firstConverter || false
        },
        {
            id: 'first-ai-question',
            title: 'AI Asistan',
            description: 'Ä°lk kez AI Assistant\'a soru sor',
            icon: 'ðŸ¤–',
            condition: states.firstAIQuestion || false
        },
        {
            id: 'custom-text',
            title: 'Ã–zel Metin',
            description: 'Kendi metnini testte kullan',
            icon: 'ðŸ“',
            condition: states.customText || false
        },
        {
            id: 'pdf-download',
            title: 'PDF Ä°ndirme',
            description: 'Okuma sonuÃ§larÄ±nÄ± PDF olarak indir',
            icon: 'ðŸ“¥',
            condition: states.pdfDownload || false
        }
    ];
    
    // UI'yi gÃ¼ncelle
    updateAchievementsUI(achievements);
}

// BaÅŸarÄ±mlarÄ± UI'de gÃ¼ncelle
function updateAchievementsUI(achievements) {
    const container = document.getElementById('achievements');
    if (!container) return;
    
    // Sayfalama iÃ§in gÃ¶revleri filtrele
    const startIndex = (currentAchievementPage - 1) * achievementsPerPage;
    const endIndex = startIndex + achievementsPerPage;
    const paginatedAchievements = achievements.slice(startIndex, endIndex);
    
    container.innerHTML = paginatedAchievements.map(achievement => {
        const isUnlocked = achievement.condition;
        const bgClass = isUnlocked ? 'bg-green-50 border-green-200' : 'bg-gray-50 border-gray-200';
        const textClass = isUnlocked ? 'text-green-700' : 'text-gray-700';
        const iconBg = isUnlocked ? 'bg-green-500' : 'bg-gray-300';
        const opacity = isUnlocked ? '' : 'opacity-60';
        
        return `
            <div class="flex items-center p-3 ${bgClass} rounded-lg border-2 ${opacity} transition-all duration-300 hover:scale-105">
                <div class="w-10 h-10 ${iconBg} rounded-full flex items-center justify-center mr-3">
                    <span class="text-lg">${achievement.icon}</span>
                </div>
                <div class="flex-1">
                    <div class="font-semibold ${textClass}">${achievement.title}</div>
                    <div class="text-xs text-gray-600 mt-1">${achievement.description}</div>
                </div>
                ${isUnlocked ? 
                    '<div class="ml-2 text-green-500 animate-pulse"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div>' : 
                    '<div class="ml-2 text-gray-400"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div>'
                }
            </div>
        `;
    }).join('');
}

// GÃ¶rev tetikleyicileri
function checkFirstLogin() {
    if (!localStorage.getItem('firstLoginChecked')) {
        updateAchievementState('firstLogin', true);
        localStorage.setItem('firstLoginChecked', 'true');
    }
}

function checkFirstTest() {
    if (window.userTestData && window.userTestData.length >= 1) {
        updateAchievementState('firstTest', true);
        
        if (window.userTestData.length >= 10) {
            updateAchievementState('tenTests', true);
        }
    }
}

// Mevcut fonksiyonlarÄ± gÃ¶rev tetikleyecek ÅŸekilde gÃ¼ncelle
function enhanceExistingFunctions() {
    // Ayarlar kaydedildiÄŸinde
    const originalSaveSettings = window.saveSettings;
    window.saveSettings = function() {
        updateAchievementState('settingsChanged', true);
        return originalSaveSettings.apply(this, arguments);
    };
    
    // DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ kullanÄ±ldÄ±ÄŸÄ±nda
    const originalConvertText = window.convertText;
    window.convertText = function() {
        updateAchievementState('firstConverter', true);
        return originalConvertText.apply(this, arguments);
    };
    
    // AI soru sorulduÄŸunda
    const originalSendMessage = window.sendMessage;
    window.sendMessage = function() {
        updateAchievementState('firstAIQuestion', true);
        return originalSendMessage.apply(this, arguments);
    };
    
    // Ã–zel metin kullanÄ±ldÄ±ÄŸÄ±nda
    const originalLoadCustomText = window.loadCustomText;
    window.loadCustomText = function() {
        updateAchievementState('customText', true);
        return originalLoadCustomText.apply(this, arguments);
    };
    
    // PDF indirildiÄŸinde
    const originalDownloadResults = window.downloadResults;
    window.downloadResults = function() {
        updateAchievementState('pdfDownload', true);
        return originalDownloadResults.apply(this, arguments);
    };
}

// Sayfa yÃ¼klendiÄŸinde Ã§alÄ±ÅŸtÄ±r
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        initializeAchievementSystem();
        enhanceExistingFunctions();
        
        // KullanÄ±cÄ± verileri yÃ¼klendikten sonra test gÃ¶revlerini kontrol et
        if (window.userTestData) {
            checkFirstTest();
        }
    }, 1000);
});

// KullanÄ±cÄ± verileri deÄŸiÅŸtiÄŸinde tetikle
function monitorUserDataChanges() {
    let oldTestDataLength = window.userTestData ? window.userTestData.length : 0;
    
    setInterval(() => {
        if (window.userTestData && window.userTestData.length !== oldTestDataLength) {
            oldTestDataLength = window.userTestData.length;
            checkFirstTest();
            updateAchievementsFromStates();
        }
    }, 2000);
}

// MonitorÃ¼ baÅŸlat
monitorUserDataChanges();

    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f94f8cf2391e4b',t:'MTc1Nzk1MTc1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
